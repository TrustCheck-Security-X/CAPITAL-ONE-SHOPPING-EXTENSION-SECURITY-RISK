import{a as u}from"./chunk-DWQLULSJ.js";import{s as _,v as g}from"./chunk-2WJMAHXV.js";import{e as v,f as w}from"./chunk-C4QCPH6A.js";import{e as d}from"./chunk-3GYLW4KZ.js";var o=d(v()),c=d(w());var m=({domain:i,pid:t,title:r})=>g("getWirelessDeviceMeta",{domain:i,pid:t,title:r});async function y(i){let t=c.default.v4();if(i.pageData?.meta?.products_list){i.pageData.products=i.pageData.meta.products_list.reduce((s,e,p)=>(!e.meta_slot_position||!e.product_titles?.length||!e.product_urls?.length||!e.product_sellers?.length||!e.product_images?.length||!e.product_brands?.length||!e.product_price_after_discounts?.length||s.push({key:p.toString(),slot_position:e.meta_slot_position,content_id:t,subcontent_id:c.default.v4(),url:e.product_urls[0],seller:e.product_sellers[0],title:e.product_titles[0],image:e.product_images[0],brand:e.product_brands[0],price_after_discount:e.product_price_after_discounts[0],price:e.product_list_prices?.[0]||null}),s),[]);let r=i.pageData.products.length,n=await u(i.pageData.products.map(s=>s.url));o.default.remove(i.pageData.products,s=>!o.default.includes(n,s.url)),o.default.set(i.pageData,"meta.domain_removed",i.pageData.products.length!==r)}}async function P(i){let t=o.default.cloneDeep(i||{}),r=t.domain||"",n=t.pageType||"",s=!!t.pageData?.tag?.some(e=>e.indexOf("wireless_device")===0);if(n==="productPage"&&s){let e=t.pageData.products?.find(l=>(l.sku||l.pid)&&l.title)||{},{sku:p,pid:f,title:D}=e,a=await m({domain:r,pid:f||p,title:D});typeof a?.id=="string"&&(e.wireless_device_id=a.id,e.wireless_device_name=a.name,e.wireless_device_type=a.type,t.pageData.wireless=Object.assign({},t.pageData.wireless||{},{deviceId:a.id}),t.pageData.tag.push(`device_id_${a.id.replaceAll("-","_")}`))}else n==="sponsoredProductsPage"&&(await y(t),t.url=null);return t}var R=_;export{P as a,R as b};
