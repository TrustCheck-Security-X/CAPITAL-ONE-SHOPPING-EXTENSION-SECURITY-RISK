import{a as pt,c as Ge,d as Lt}from"./chunk-TY2WWATK.js";import{a as Ie}from"./chunk-QCPV2SDO.js";import{a as ar}from"./chunk-H45DLGCI.js";import{a as nr}from"./chunk-MYY6QNB4.js";import{c as rr,d as cr}from"./chunk-WCQV4SF3.js";import{a as er,b as ir,d as sr}from"./chunk-X2IWIW6K.js";import{c as tr,e as or}from"./chunk-JFLVCXPX.js";import{a as Ji}from"./chunk-M25S27FE.js";import{a as Dt,b as Mi,c as Oi,d as Fc}from"./chunk-J7QHBV67.js";import{a as Pi,b as Ri,c as ji,i as Wc}from"./chunk-VGEMM5MB.js";import{a as lt,e as Wi}from"./chunk-2JQDE4PE.js";import{b as $i,c as qi}from"./chunk-FMNBUMJ5.js";import{a as Nt}from"./chunk-CXSZXIOJ.js";import{a as Mt,b as Ao,d as Yi,e as Pt}from"./chunk-QLZPWOED.js";import{f as Vi}from"./chunk-OCTA2RVM.js";import{a as Qi}from"./chunk-YQ5KARKK.js";import{b as ee}from"./chunk-DKGSS5NA.js";import{a as Ki}from"./chunk-IJEQYNEP.js";import{a as He}from"./chunk-TFT336KV.js";import{a as Vc,d as q,j as At,k as Yc,l as Xc,m as Fe,o as Xi,p as Zi,q as Rt}from"./chunk-4MWWZMVF.js";import{a as S,c as $c,h as d,i as Gi,n as O,o as x,p as qc,q as Kc,v as N}from"./chunk-2WJMAHXV.js";import{a as Bi,d as Hc}from"./chunk-W7K6NY26.js";import{b as Ii,g as Eo,k as Ai,l as Ni,n as je,s as Et}from"./chunk-QWQLNDJC.js";import{a as zi,b as Ui,c as Gc}from"./chunk-WRIUWJSJ.js";import{F as It,G as b,I as Fi,c as Nc,f as Mc,g as Pc,k as Rc,o as Lc,p as Oc,r as Li,s as Bc,t as zc,u as Uc,v as jc,z as L}from"./chunk-4MSTBY6L.js";import{a as Ic,d as Ac}from"./chunk-CBPLEXH3.js";import{a as Tc,b as Ec,e as Z,f as Dc}from"./chunk-C4QCPH6A.js";import{k as Do}from"./chunk-53OM6ECF.js";import{f as ct,h as De,m as Hi,t as Io}from"./chunk-BTBTC4NL.js";import{c as U,e as p}from"./chunk-3GYLW4KZ.js";var jn=U((B1,ho)=>{(function(){"use strict";var e=!!(typeof window<"u"&&window.document&&window.document.createElement),t={canUseDOM:e,canUseWorkers:typeof Worker<"u",canUseEventListeners:e&&!!(window.addEventListener||window.attachEvent),canUseViewport:e&&!!window.screen};typeof define=="function"&&typeof define.amd=="object"&&define.amd?define(function(){return t}):typeof ho<"u"&&ho.exports?ho.exports=t:window.ExecutionEnvironment=t})()});var gi=U((cC,Kn)=>{var Kd=Nc(),Vd=function(){try{var e=Kd(Object,"defineProperty");return e({},"",{}),e}catch{}}();Kn.exports=Vd});var Xn=U((lC,Yn)=>{var Vn=gi();function Yd(e,t,o){t=="__proto__"&&Vn?Vn(e,t,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[t]=o}Yn.exports=Yd});var Qn=U((pC,Zn)=>{var Xd=Xn(),Zd=Rc(),Qd=Object.prototype,Jd=Qd.hasOwnProperty;function em(e,t,o){var i=e[t];(!(Jd.call(e,t)&&Zd(i,o))||o===void 0&&!(t in e))&&Xd(e,t,o)}Zn.exports=em});var ts=U((fC,es)=>{var tm=Qn(),om=Li(),im=Oc(),Jn=Ic(),rm=Bc();function am(e,t,o,i){if(!Jn(e))return e;t=om(t,e);for(var r=-1,a=t.length,n=a-1,s=e;s!=null&&++r<a;){var c=rm(t[r]),l=o;if(c==="__proto__"||c==="constructor"||c==="prototype")return e;if(r!=n){var m=s[c];l=i?i(m,c,s):void 0,l===void 0&&(l=Jn(m)?m:im(t[r+1])?[]:{})}tm(s,c,l),s=s[c]}return e}es.exports=am});var is=U((uC,os)=>{var nm=zc(),sm=ts(),cm=Li();function lm(e,t,o){for(var i=-1,r=t.length,a={};++i<r;){var n=t[i],s=nm(e,n);o(s,n)&&sm(a,cm(n,e),s)}return a}os.exports=lm});var as=U((dC,rs)=>{var pm=is(),fm=Uc();function um(e,t){return pm(e,t,function(o,i){return fm(e,i)})}rs.exports=um});var ls=U((mC,cs)=>{var ns=Ac(),dm=Mc(),mm=Pc(),ss=ns?ns.isConcatSpreadable:void 0;function hm(e){return mm(e)||dm(e)||!!(ss&&e&&e[ss])}cs.exports=hm});var us=U((hC,fs)=>{var gm=Lc(),bm=ls();function ps(e,t,o,i,r){var a=-1,n=e.length;for(o||(o=bm),r||(r=[]);++a<n;){var s=e[a];t>0&&o(s)?t>1?ps(s,t-1,o,i,r):gm(r,s):i||(r[r.length]=s)}return r}fs.exports=ps});var ms=U((gC,ds)=>{var ym=us();function xm(e){var t=e==null?0:e.length;return t?ym(e,1):[]}ds.exports=xm});var gs=U((bC,hs)=>{function wm(e,t,o){switch(o.length){case 0:return e.call(t);case 1:return e.call(t,o[0]);case 2:return e.call(t,o[0],o[1]);case 3:return e.call(t,o[0],o[1],o[2])}return e.apply(t,o)}hs.exports=wm});var xs=U((yC,ys)=>{var _m=gs(),bs=Math.max;function vm(e,t,o){return t=bs(t===void 0?e.length-1:t,0),function(){for(var i=arguments,r=-1,a=bs(i.length-t,0),n=Array(a);++r<a;)n[r]=i[t+r];r=-1;for(var s=Array(t+1);++r<t;)s[r]=i[r];return s[t]=o(n),_m(e,this,s)}}ys.exports=vm});var _s=U((xC,ws)=>{function km(e){return function(){return e}}ws.exports=km});var Cs=U((wC,ks)=>{var Cm=_s(),vs=gi(),Sm=jc(),Tm=vs?function(e,t){return vs(e,"toString",{configurable:!0,enumerable:!1,value:Cm(t),writable:!0})}:Sm;ks.exports=Tm});var Ts=U((_C,Ss)=>{var Em=800,Dm=16,Im=Date.now;function Am(e){var t=0,o=0;return function(){var i=Im(),r=Dm-(i-o);if(o=i,r>0){if(++t>=Em)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}Ss.exports=Am});var Ds=U((vC,Es)=>{var Nm=Cs(),Mm=Ts(),Pm=Mm(Nm);Es.exports=Pm});var As=U((kC,Is)=>{var Rm=ms(),Lm=xs(),Om=Ds();function Bm(e){return Om(Lm(e,void 0,Rm),e+"")}Is.exports=Bm});var Ms=U((CC,Ns)=>{var zm=as(),Um=As(),jm=Um(function(e,t){return e==null?{}:zm(e,t)});Ns.exports=jm});var Xs=U(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});var Ks=function(){function e(t,o){var i=[],r=!0,a=!1,n=void 0;try{for(var s=t[Symbol.iterator](),c;!(r=(c=s.next()).done)&&(i.push(c.value),!(o&&i.length===o));r=!0);}catch(l){a=!0,n=l}finally{try{!r&&s.return&&s.return()}finally{if(a)throw n}}return i}return function(t,o){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,o);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();_o.useRoot=eh;_o.useBranch=th;var st=L(),qs=ki(st),Vs=Yc(),Xm=Tc(),Ys=ki(Xm),Zm=Xc(),vi=ki(Zm);function ki(e){return e&&e.__esModule?e:{default:e}}var Ci=Ys.default.helpers.makeError,Qm=Ys.default.type.object;function Jm(e,t){throw Ci('baobab-react/hooks.useBranch: given cursors mapping is invalid (check the "'+e+'" component).',{mapping:t})}function eh(e){if(!(0,Vs.isBaobabTree)(e))throw Ci("baobab-react/hooks.useRoot: given tree is not a Baobab.",{target:e});var t=(0,st.useState)(function(){return function(a){var n=a.children;return qs.default.createElement(vi.default.Provider,{value:{tree:e}},n)}}),o=Ks(t,2),i=o[0],r=o[1];return(0,st.useEffect)(function(){r(function(){return function(a){var n=a.children;return qs.default.createElement(vi.default.Provider,{value:{tree:e}},n)}})},[e]),i}function th(e){!Qm(e)&&typeof e!="function"&&Jm(name,e);var t=(0,st.useContext)(vi.default);if(!t||!(0,Vs.isBaobabTree)(t.tree))throw Ci("baobab-react/hooks.useBranch: tree is not available.");var o=(0,st.useState)(function(){var n=typeof e=="function"?e(t):e,s=t.tree.project(n);return s.dispatch=function(c){for(var l=arguments.length,m=Array(l>1?l-1:0),u=1;u<l;u++)m[u-1]=arguments[u];return c.apply(void 0,[t.tree].concat(m))},s}),i=Ks(o,2),r=i[0],a=i[1];return(0,st.useEffect)(function(){var n=typeof e=="function"?e(t):e,s=t.tree.watch(n);return s.on("update",function(){var c=s.get();c.dispatch=function(l){for(var m=arguments.length,u=Array(m>1?m-1:0),f=1;f<m;f++)u[f-1]=arguments[f];return l.apply(void 0,[t.tree].concat(u))},a(c)}),function(){return s.release()}},[e]),r}});var Qs=U(Si=>{var Zs=Xs();Si.useRoot=Zs.useRoot;Si.useBranch=Zs.useBranch});function We({automaticCouponsRun:e,autoFallback:t,isSiteHub:o,isCouponsImmediate:i,sameTabAffiliateRedirect:r}={}){return e?"auto":t?"auto_fallback":o?"site_hub":i?"immediate":r?"page_reload":null}Et();var Zc=typeof window=="object"&&window&&window.Object===Object&&window,Ot=Zc;var Qc=typeof self=="object"&&self&&self.Object===Object&&self,Jc=Ot||Qc||Function("return this")(),j=Jc;var el=j.Symbol,Q=el;var lr=Object.prototype,tl=lr.hasOwnProperty,ol=lr.toString,ft=Q?Q.toStringTag:void 0;function il(e){var t=tl.call(e,ft),o=e[ft];try{e[ft]=void 0;var i=!0}catch{}var r=ol.call(e);return i&&(t?e[ft]=o:delete e[ft]),r}var pr=il;var rl=Object.prototype,al=rl.toString;function nl(e){return al.call(e)}var fr=nl;var sl="[object Null]",cl="[object Undefined]",ur=Q?Q.toStringTag:void 0;function ll(e){return e==null?e===void 0?cl:sl:ur&&ur in Object(e)?pr(e):fr(e)}var te=ll;function pl(e){return e!=null&&typeof e=="object"}var oe=pl;var fl="[object Symbol]";function ul(e){return typeof e=="symbol"||oe(e)&&te(e)==fl}var he=ul;function dl(e,t){for(var o=-1,i=e==null?0:e.length,r=Array(i);++o<i;)r[o]=t(e[o],o,e);return r}var dr=dl;var ml=Array.isArray,H=ml;var hl=1/0,mr=Q?Q.prototype:void 0,hr=mr?mr.toString:void 0;function gr(e){if(typeof e=="string")return e;if(H(e))return dr(e,gr)+"";if(he(e))return hr?hr.call(e):"";var t=e+"";return t=="0"&&1/e==-hl?"-0":t}var br=gr;var gl=/\s/;function bl(e){for(var t=e.length;t--&&gl.test(e.charAt(t)););return t}var yr=bl;var yl=/^\s+/;function xl(e){return e&&e.slice(0,yr(e)+1).replace(yl,"")}var xr=xl;function wl(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var ie=wl;var wr=NaN,_l=/^[-+]0x[0-9a-f]+$/i,vl=/^0b[01]+$/i,kl=/^0o[0-7]+$/i,Cl=parseInt;function Sl(e){if(typeof e=="number")return e;if(he(e))return wr;if(ie(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ie(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=xr(e);var o=vl.test(e);return o||kl.test(e)?Cl(e.slice(2),o?2:8):_l.test(e)?wr:+e}var ut=Sl;var _r=1/0,Tl=17976931348623157e292;function El(e){if(!e)return e===0?e:0;if(e=ut(e),e===_r||e===-_r){var t=e<0?-1:1;return t*Tl}return e===e?e:0}var vr=El;function Dl(e){var t=vr(e),o=t%1;return t===t?o?t-o:t:0}var kr=Dl;function Il(e){return e}var Cr=Il;var Al="[object AsyncFunction]",Nl="[object Function]",Ml="[object GeneratorFunction]",Pl="[object Proxy]";function Rl(e){if(!ie(e))return!1;var t=te(e);return t==Nl||t==Ml||t==Al||t==Pl}var Bt=Rl;var Ll=j["__core-js_shared__"],zt=Ll;var Sr=function(){var e=/[^.]+$/.exec(zt&&zt.keys&&zt.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Ol(e){return!!Sr&&Sr in e}var Tr=Ol;var Bl=Function.prototype,zl=Bl.toString;function Ul(e){if(e!=null){try{return zl.call(e)}catch{}try{return e+""}catch{}}return""}var pe=Ul;var jl=/[\\^$.*+?()[\]{}|]/g,Fl=/^\[object .+?Constructor\]$/,Hl=Function.prototype,Gl=Object.prototype,Wl=Hl.toString,$l=Gl.hasOwnProperty,ql=RegExp("^"+Wl.call($l).replace(jl,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Kl(e){if(!ie(e)||Tr(e))return!1;var t=Bt(e)?ql:Fl;return t.test(pe(e))}var Er=Kl;function Vl(e,t){return e?.[t]}var Dr=Vl;function Yl(e,t){var o=Dr(e,t);return Er(o)?o:void 0}var J=Yl;var Xl=J(j,"WeakMap"),Ut=Xl;function Zl(){}var Ir=Zl;function Ql(e,t,o,i){for(var r=e.length,a=o+(i?1:-1);i?a--:++a<r;)if(t(e[a],a,e))return a;return-1}var Ar=Ql;function Jl(e){return e!==e}var Nr=Jl;function ep(e,t,o){for(var i=o-1,r=e.length;++i<r;)if(e[i]===t)return i;return-1}var Mr=ep;function tp(e,t,o){return t===t?Mr(e,t,o):Ar(e,Nr,o)}var Pr=tp;function op(e,t){var o=e==null?0:e.length;return!!o&&Pr(e,t,0)>-1}var Rr=op;var ip=9007199254740991,rp=/^(?:0|[1-9]\d*)$/;function ap(e,t){var o=typeof e;return t=t??ip,!!t&&(o=="number"||o!="symbol"&&rp.test(e))&&e>-1&&e%1==0&&e<t}var jt=ap;function np(e,t){return e===t||e!==e&&t!==t}var Ft=np;var sp=9007199254740991;function cp(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=sp}var $e=cp;function lp(e){return e!=null&&$e(e.length)&&!Bt(e)}var Lr=lp;var pp=Object.prototype;function fp(e){var t=e&&e.constructor,o=typeof t=="function"&&t.prototype||pp;return e===o}var Or=fp;function up(e,t){for(var o=-1,i=Array(e);++o<e;)i[o]=t(o);return i}var Br=up;var dp="[object Arguments]";function mp(e){return oe(e)&&te(e)==dp}var No=mp;var zr=Object.prototype,hp=zr.hasOwnProperty,gp=zr.propertyIsEnumerable,bp=No(function(){return arguments}())?No:function(e){return oe(e)&&hp.call(e,"callee")&&!gp.call(e,"callee")},Ht=bp;function yp(){return!1}var Ur=yp;var Hr=typeof exports=="object"&&exports&&!exports.nodeType&&exports,jr=Hr&&typeof module=="object"&&module&&!module.nodeType&&module,xp=jr&&jr.exports===Hr,Fr=xp?j.Buffer:void 0,wp=Fr?Fr.isBuffer:void 0,_p=wp||Ur,dt=_p;var vp="[object Arguments]",kp="[object Array]",Cp="[object Boolean]",Sp="[object Date]",Tp="[object Error]",Ep="[object Function]",Dp="[object Map]",Ip="[object Number]",Ap="[object Object]",Np="[object RegExp]",Mp="[object Set]",Pp="[object String]",Rp="[object WeakMap]",Lp="[object ArrayBuffer]",Op="[object DataView]",Bp="[object Float32Array]",zp="[object Float64Array]",Up="[object Int8Array]",jp="[object Int16Array]",Fp="[object Int32Array]",Hp="[object Uint8Array]",Gp="[object Uint8ClampedArray]",Wp="[object Uint16Array]",$p="[object Uint32Array]",P={};P[Bp]=P[zp]=P[Up]=P[jp]=P[Fp]=P[Hp]=P[Gp]=P[Wp]=P[$p]=!0;P[vp]=P[kp]=P[Lp]=P[Cp]=P[Op]=P[Sp]=P[Tp]=P[Ep]=P[Dp]=P[Ip]=P[Ap]=P[Np]=P[Mp]=P[Pp]=P[Rp]=!1;function qp(e){return oe(e)&&$e(e.length)&&!!P[te(e)]}var Gr=qp;function Kp(e){return function(t){return e(t)}}var Wr=Kp;var $r=typeof exports=="object"&&exports&&!exports.nodeType&&exports,mt=$r&&typeof module=="object"&&module&&!module.nodeType&&module,Vp=mt&&mt.exports===$r,Mo=Vp&&Ot.process,Yp=function(){try{var e=mt&&mt.require&&mt.require("util").types;return e||Mo&&Mo.binding&&Mo.binding("util")}catch{}}(),Po=Yp;var qr=Po&&Po.isTypedArray,Xp=qr?Wr(qr):Gr,Gt=Xp;var Zp=Object.prototype,Qp=Zp.hasOwnProperty;function Jp(e,t){var o=H(e),i=!o&&Ht(e),r=!o&&!i&&dt(e),a=!o&&!i&&!r&&Gt(e),n=o||i||r||a,s=n?Br(e.length,String):[],c=s.length;for(var l in e)(t||Qp.call(e,l))&&!(n&&(l=="length"||r&&(l=="offset"||l=="parent")||a&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||jt(l,c)))&&s.push(l);return s}var Kr=Jp;function ef(e,t){return function(o){return e(t(o))}}var Vr=ef;var tf=Vr(Object.keys,Object),Yr=tf;var of=Object.prototype,rf=of.hasOwnProperty;function af(e){if(!Or(e))return Yr(e);var t=[];for(var o in Object(e))rf.call(e,o)&&o!="constructor"&&t.push(o);return t}var Xr=af;function nf(e){return Lr(e)?Kr(e):Xr(e)}var Wt=nf;var sf=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,cf=/^\w*$/;function lf(e,t){if(H(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||he(e)?!0:cf.test(e)||!sf.test(e)||t!=null&&e in Object(t)}var qe=lf;var pf=J(Object,"create"),fe=pf;function ff(){this.__data__=fe?fe(null):{},this.size=0}var Zr=ff;function uf(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Qr=uf;var df="__lodash_hash_undefined__",mf=Object.prototype,hf=mf.hasOwnProperty;function gf(e){var t=this.__data__;if(fe){var o=t[e];return o===df?void 0:o}return hf.call(t,e)?t[e]:void 0}var Jr=gf;var bf=Object.prototype,yf=bf.hasOwnProperty;function xf(e){var t=this.__data__;return fe?t[e]!==void 0:yf.call(t,e)}var ea=xf;var wf="__lodash_hash_undefined__";function _f(e,t){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=fe&&t===void 0?wf:t,this}var ta=_f;function Ke(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var i=e[t];this.set(i[0],i[1])}}Ke.prototype.clear=Zr;Ke.prototype.delete=Qr;Ke.prototype.get=Jr;Ke.prototype.has=ea;Ke.prototype.set=ta;var Ro=Ke;function vf(){this.__data__=[],this.size=0}var oa=vf;function kf(e,t){for(var o=e.length;o--;)if(Ft(e[o][0],t))return o;return-1}var ge=kf;var Cf=Array.prototype,Sf=Cf.splice;function Tf(e){var t=this.__data__,o=ge(t,e);if(o<0)return!1;var i=t.length-1;return o==i?t.pop():Sf.call(t,o,1),--this.size,!0}var ia=Tf;function Ef(e){var t=this.__data__,o=ge(t,e);return o<0?void 0:t[o][1]}var ra=Ef;function Df(e){return ge(this.__data__,e)>-1}var aa=Df;function If(e,t){var o=this.__data__,i=ge(o,e);return i<0?(++this.size,o.push([e,t])):o[i][1]=t,this}var na=If;function Ve(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var i=e[t];this.set(i[0],i[1])}}Ve.prototype.clear=oa;Ve.prototype.delete=ia;Ve.prototype.get=ra;Ve.prototype.has=aa;Ve.prototype.set=na;var be=Ve;var Af=J(j,"Map"),ye=Af;function Nf(){this.size=0,this.__data__={hash:new Ro,map:new(ye||be),string:new Ro}}var sa=Nf;function Mf(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var ca=Mf;function Pf(e,t){var o=e.__data__;return ca(t)?o[typeof t=="string"?"string":"hash"]:o.map}var xe=Pf;function Rf(e){var t=xe(this,e).delete(e);return this.size-=t?1:0,t}var la=Rf;function Lf(e){return xe(this,e).get(e)}var pa=Lf;function Of(e){return xe(this,e).has(e)}var fa=Of;function Bf(e,t){var o=xe(this,e),i=o.size;return o.set(e,t),this.size+=o.size==i?0:1,this}var ua=Bf;function Ye(e){var t=-1,o=e==null?0:e.length;for(this.clear();++t<o;){var i=e[t];this.set(i[0],i[1])}}Ye.prototype.clear=sa;Ye.prototype.delete=la;Ye.prototype.get=pa;Ye.prototype.has=fa;Ye.prototype.set=ua;var Ae=Ye;var zf="Expected a function";function Lo(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(zf);var o=function(){var i=arguments,r=t?t.apply(this,i):i[0],a=o.cache;if(a.has(r))return a.get(r);var n=e.apply(this,i);return o.cache=a.set(r,n)||a,n};return o.cache=new(Lo.Cache||Ae),o}Lo.Cache=Ae;var da=Lo;var Uf=500;function jf(e){var t=da(e,function(i){return o.size===Uf&&o.clear(),i}),o=t.cache;return t}var ma=jf;var Ff=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Hf=/\\(\\)?/g,Gf=ma(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Ff,function(o,i,r,a){t.push(r?a.replace(Hf,"$1"):i||o)}),t}),ha=Gf;function Wf(e){return e==null?"":br(e)}var ga=Wf;function $f(e,t){return H(e)?e:qe(e,t)?[e]:ha(ga(e))}var $t=$f;var qf=1/0;function Kf(e){if(typeof e=="string"||he(e))return e;var t=e+"";return t=="0"&&1/e==-qf?"-0":t}var we=Kf;function Vf(e,t){t=$t(t,e);for(var o=0,i=t.length;e!=null&&o<i;)e=e[we(t[o++])];return o&&o==i?e:void 0}var qt=Vf;function Yf(e,t,o){var i=e==null?void 0:qt(e,t);return i===void 0?o:i}var ba=Yf;function Xf(e,t){for(var o=-1,i=t.length,r=e.length;++o<i;)e[r+o]=t[o];return e}var ya=Xf;var Zf="Expected a function";function Qf(e,t){var o;if(typeof t!="function")throw new TypeError(Zf);return e=kr(e),function(){return--e>0&&(o=t.apply(this,arguments)),e<=1&&(t=void 0),o}}var xa=Qf;function Jf(){this.__data__=new be,this.size=0}var wa=Jf;function eu(e){var t=this.__data__,o=t.delete(e);return this.size=t.size,o}var _a=eu;function tu(e){return this.__data__.get(e)}var va=tu;function ou(e){return this.__data__.has(e)}var ka=ou;var iu=200;function ru(e,t){var o=this.__data__;if(o instanceof be){var i=o.__data__;if(!ye||i.length<iu-1)return i.push([e,t]),this.size=++o.size,this;o=this.__data__=new Ae(i)}return o.set(e,t),this.size=o.size,this}var Ca=ru;function Xe(e){var t=this.__data__=new be(e);this.size=t.size}Xe.prototype.clear=wa;Xe.prototype.delete=_a;Xe.prototype.get=va;Xe.prototype.has=ka;Xe.prototype.set=Ca;var Ze=Xe;function au(e,t){for(var o=-1,i=e==null?0:e.length,r=0,a=[];++o<i;){var n=e[o];t(n,o,e)&&(a[r++]=n)}return a}var Sa=au;function nu(){return[]}var Ta=nu;var su=Object.prototype,cu=su.propertyIsEnumerable,Ea=Object.getOwnPropertySymbols,lu=Ea?function(e){return e==null?[]:(e=Object(e),Sa(Ea(e),function(t){return cu.call(e,t)}))}:Ta,Da=lu;function pu(e,t,o){var i=t(e);return H(e)?i:ya(i,o(e))}var Ia=pu;function fu(e){return Ia(e,Wt,Da)}var Oo=fu;var uu=J(j,"DataView"),Kt=uu;var du=J(j,"Promise"),Vt=du;var mu=J(j,"Set"),_e=mu;var Aa="[object Map]",hu="[object Object]",Na="[object Promise]",Ma="[object Set]",Pa="[object WeakMap]",Ra="[object DataView]",gu=pe(Kt),bu=pe(ye),yu=pe(Vt),xu=pe(_e),wu=pe(Ut),Ne=te;(Kt&&Ne(new Kt(new ArrayBuffer(1)))!=Ra||ye&&Ne(new ye)!=Aa||Vt&&Ne(Vt.resolve())!=Na||_e&&Ne(new _e)!=Ma||Ut&&Ne(new Ut)!=Pa)&&(Ne=function(e){var t=te(e),o=t==hu?e.constructor:void 0,i=o?pe(o):"";if(i)switch(i){case gu:return Ra;case bu:return Aa;case yu:return Na;case xu:return Ma;case wu:return Pa}return t});var Bo=Ne;var _u=j.Uint8Array,zo=_u;var vu="__lodash_hash_undefined__";function ku(e){return this.__data__.set(e,vu),this}var La=ku;function Cu(e){return this.__data__.has(e)}var Oa=Cu;function Yt(e){var t=-1,o=e==null?0:e.length;for(this.__data__=new Ae;++t<o;)this.add(e[t])}Yt.prototype.add=Yt.prototype.push=La;Yt.prototype.has=Oa;var Xt=Yt;function Su(e,t){for(var o=-1,i=e==null?0:e.length;++o<i;)if(t(e[o],o,e))return!0;return!1}var Ba=Su;function Tu(e,t){return e.has(t)}var Zt=Tu;var Eu=1,Du=2;function Iu(e,t,o,i,r,a){var n=o&Eu,s=e.length,c=t.length;if(s!=c&&!(n&&c>s))return!1;var l=a.get(e),m=a.get(t);if(l&&m)return l==t&&m==e;var u=-1,f=!0,w=o&Du?new Xt:void 0;for(a.set(e,t),a.set(t,e);++u<s;){var v=e[u],y=t[u];if(i)var h=n?i(y,v,u,t,e,a):i(v,y,u,e,t,a);if(h!==void 0){if(h)continue;f=!1;break}if(w){if(!Ba(t,function(g,k){if(!Zt(w,k)&&(v===g||r(v,g,o,i,a)))return w.push(k)})){f=!1;break}}else if(!(v===y||r(v,y,o,i,a))){f=!1;break}}return a.delete(e),a.delete(t),f}var Qt=Iu;function Au(e){var t=-1,o=Array(e.size);return e.forEach(function(i,r){o[++t]=[r,i]}),o}var za=Au;function Nu(e){var t=-1,o=Array(e.size);return e.forEach(function(i){o[++t]=i}),o}var Qe=Nu;var Mu=1,Pu=2,Ru="[object Boolean]",Lu="[object Date]",Ou="[object Error]",Bu="[object Map]",zu="[object Number]",Uu="[object RegExp]",ju="[object Set]",Fu="[object String]",Hu="[object Symbol]",Gu="[object ArrayBuffer]",Wu="[object DataView]",Ua=Q?Q.prototype:void 0,Uo=Ua?Ua.valueOf:void 0;function $u(e,t,o,i,r,a,n){switch(o){case Wu:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Gu:return!(e.byteLength!=t.byteLength||!a(new zo(e),new zo(t)));case Ru:case Lu:case zu:return Ft(+e,+t);case Ou:return e.name==t.name&&e.message==t.message;case Uu:case Fu:return e==t+"";case Bu:var s=za;case ju:var c=i&Mu;if(s||(s=Qe),e.size!=t.size&&!c)return!1;var l=n.get(e);if(l)return l==t;i|=Pu,n.set(e,t);var m=Qt(s(e),s(t),i,r,a,n);return n.delete(e),m;case Hu:if(Uo)return Uo.call(e)==Uo.call(t)}return!1}var ja=$u;var qu=1,Ku=Object.prototype,Vu=Ku.hasOwnProperty;function Yu(e,t,o,i,r,a){var n=o&qu,s=Oo(e),c=s.length,l=Oo(t),m=l.length;if(c!=m&&!n)return!1;for(var u=c;u--;){var f=s[u];if(!(n?f in t:Vu.call(t,f)))return!1}var w=a.get(e),v=a.get(t);if(w&&v)return w==t&&v==e;var y=!0;a.set(e,t),a.set(t,e);for(var h=n;++u<c;){f=s[u];var g=e[f],k=t[f];if(i)var $=n?i(k,g,f,t,e,a):i(g,k,f,e,t,a);if(!($===void 0?g===k||r(g,k,o,i,a):$)){y=!1;break}h||(h=f=="constructor")}if(y&&!h){var z=e.constructor,A=t.constructor;z!=A&&"constructor"in e&&"constructor"in t&&!(typeof z=="function"&&z instanceof z&&typeof A=="function"&&A instanceof A)&&(y=!1)}return a.delete(e),a.delete(t),y}var Fa=Yu;var Xu=1,Ha="[object Arguments]",Ga="[object Array]",Jt="[object Object]",Zu=Object.prototype,Wa=Zu.hasOwnProperty;function Qu(e,t,o,i,r,a){var n=H(e),s=H(t),c=n?Ga:Bo(e),l=s?Ga:Bo(t);c=c==Ha?Jt:c,l=l==Ha?Jt:l;var m=c==Jt,u=l==Jt,f=c==l;if(f&&dt(e)){if(!dt(t))return!1;n=!0,m=!1}if(f&&!m)return a||(a=new Ze),n||Gt(e)?Qt(e,t,o,i,r,a):ja(e,t,c,o,i,r,a);if(!(o&Xu)){var w=m&&Wa.call(e,"__wrapped__"),v=u&&Wa.call(t,"__wrapped__");if(w||v){var y=w?e.value():e,h=v?t.value():t;return a||(a=new Ze),r(y,h,o,i,a)}}return f?(a||(a=new Ze),Fa(e,t,o,i,r,a)):!1}var $a=Qu;function qa(e,t,o,i,r){return e===t?!0:e==null||t==null||!oe(e)&&!oe(t)?e!==e&&t!==t:$a(e,t,o,i,qa,r)}var eo=qa;var Ju=1,ed=2;function td(e,t,o,i){var r=o.length,a=r,n=!i;if(e==null)return!a;for(e=Object(e);r--;){var s=o[r];if(n&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++r<a;){s=o[r];var c=s[0],l=e[c],m=s[1];if(n&&s[2]){if(l===void 0&&!(c in e))return!1}else{var u=new Ze;if(i)var f=i(l,m,c,e,t,u);if(!(f===void 0?eo(m,l,Ju|ed,i,u):f))return!1}}return!0}var Ka=td;function od(e){return e===e&&!ie(e)}var to=od;function id(e){for(var t=Wt(e),o=t.length;o--;){var i=t[o],r=e[i];t[o]=[i,r,to(r)]}return t}var Va=id;function rd(e,t){return function(o){return o==null?!1:o[e]===t&&(t!==void 0||e in Object(o))}}var oo=rd;function ad(e){var t=Va(e);return t.length==1&&t[0][2]?oo(t[0][0],t[0][1]):function(o){return o===e||Ka(o,e,t)}}var Ya=ad;function nd(e,t){return e!=null&&t in Object(e)}var Xa=nd;function sd(e,t,o){t=$t(t,e);for(var i=-1,r=t.length,a=!1;++i<r;){var n=we(t[i]);if(!(a=e!=null&&o(e,n)))break;e=e[n]}return a||++i!=r?a:(r=e==null?0:e.length,!!r&&$e(r)&&jt(n,r)&&(H(e)||Ht(e)))}var Za=sd;function cd(e,t){return e!=null&&Za(e,t,Xa)}var Qa=cd;var ld=1,pd=2;function fd(e,t){return qe(e)&&to(t)?oo(we(e),t):function(o){var i=ba(o,e);return i===void 0&&i===t?Qa(o,e):eo(t,i,ld|pd)}}var Ja=fd;function ud(e){return function(t){return t?.[e]}}var en=ud;function dd(e){return function(t){return qt(t,e)}}var tn=dd;function md(e){return qe(e)?en(we(e)):tn(e)}var on=md;function hd(e){return typeof e=="function"?e:e==null?Cr:typeof e=="object"?H(e)?Ja(e[0],e[1]):Ya(e):on(e)}var rn=hd;var gd=function(){return j.Date.now()},io=gd;var bd="Expected a function",yd=Math.max,xd=Math.min;function wd(e,t,o){var i,r,a,n,s,c,l=0,m=!1,u=!1,f=!0;if(typeof e!="function")throw new TypeError(bd);t=ut(t)||0,ie(o)&&(m=!!o.leading,u="maxWait"in o,a=u?yd(ut(o.maxWait)||0,t):a,f="trailing"in o?!!o.trailing:f);function w(T){var D=i,I=r;return i=r=void 0,l=T,n=e.apply(I,D),n}function v(T){return l=T,s=setTimeout(g,t),m?w(T):n}function y(T){var D=T-c,I=T-l,X=t-D;return u?xd(X,a-I):X}function h(T){var D=T-c,I=T-l;return c===void 0||D>=t||D<0||u&&I>=a}function g(){var T=io();if(h(T))return k(T);s=setTimeout(g,y(T))}function k(T){return s=void 0,f&&i?w(T):(i=r=void 0,n)}function $(){s!==void 0&&clearTimeout(s),l=0,i=c=r=s=void 0}function z(){return s===void 0?n:k(io())}function A(){var T=io(),D=h(T);if(i=arguments,r=this,c=T,D){if(s===void 0)return v(c);if(u)return clearTimeout(s),s=setTimeout(g,t),w(c)}return s===void 0&&(s=setTimeout(g,t)),n}return A.cancel=$,A.flush=z,A}var jo=wd;function _d(e,t,o){for(var i=-1,r=e==null?0:e.length;++i<r;)if(o(t,e[i]))return!0;return!1}var an=_d;function vd(e){return xa(2,e)}var Fo=vd;var kd=1/0,Cd=_e&&1/Qe(new _e([,-0]))[1]==kd?function(e){return new _e(e)}:Ir,nn=Cd;var Sd=200;function Td(e,t,o){var i=-1,r=Rr,a=e.length,n=!0,s=[],c=s;if(o)n=!1,r=an;else if(a>=Sd){var l=t?null:nn(e);if(l)return Qe(l);n=!1,r=Zt,c=new Xt}else c=t?[]:s;e:for(;++i<a;){var m=e[i],u=t?t(m):m;if(m=o||m!==0?m:0,n&&u===u){for(var f=c.length;f--;)if(c[f]===u)continue e;t&&c.push(u),s.push(m)}else r(c,u,o)||(c!==s&&c.push(u),s.push(m))}return s}var sn=Td;function Ed(e,t){return e&&e.length?sn(e,rn(t,2)):[]}var Ho=Ed;Io();var pn=p($c());var ln=p(qc()),$o=p(Ec()),qo=p(Kc());Io();Io();async function K(e){return De(Hi(e??0))}var cn=p(Do());function Me(e,t){let o=e.replace(/[^0-9]/gi,"");if(!e.trim().match(/\d+[\t\n\r]*[.,\t\n\r][\t\n\r]*\d{2}($|\D)+/)){let r=!!e.trim().match(/[.,\t\n\r][\t\n\r]*\d{1}($|\D)+/)?parseFloat(o).toFixed(1).replace(/[^0-9]/gi,""):parseFloat(o).toFixed(2).replace(/[^0-9]/gi,"");t&&r!==o&&t("track","rooPriceDifference",{domain:cn.default.getDomain(location.href),pagePath:location.pathname,url:location.href,parsePriceTotal:o,fixedPriceTotal:r}),o=r}return parseInt(o)}async function ro(e,t,o){let i=new Event(e,o);t.dispatchEvent(i)}async function Go(e,t,o){try{let i=o.charCodeAt(0),r=document.createEvent("KeyboardEvent");Object.defineProperty(r,"keyCode",{get:function(){return this.charCodeVal}}),Object.defineProperty(r,"which",{get:function(){return this.charCodeVal}}),r.initKeyboardEvent?r.initKeyboardEvent(e,!0,!0,document.defaultView,!1,!1,!1,!1,i,i):r.initKeyEvent(e,!0,!0,document.defaultView,!1,!1,!1,!1,i,0),r.charCodeVal=i,t.dispatchEvent(r),e==="keypress"&&(t.contentEditable==="true"&&(t.textContent=t.textContent+o),t.value=t.value+o)}catch{}}async function Dd(e,t){return await K(10),Go("keydown",t,e).then(()=>Go("keypress",t,e)).then(()=>ro("input",t,{bubbles:!0})).then(()=>ro("change",t)).then(()=>Go("keyup",t,e))}async function Wo(e,t){await ro("focus",e);for(let o=0;o<t.length;++o)await Dd(t[o],e);await ro("blur",e)}var ao=class{constructor(t,o){this.onIsNotCouponPage=()=>{};this.sendShoppingEvent=()=>{};this.hasFeature=t=>!1;this._xhrQuietMonitor$=t,Object.assign(this,o)}getElement(t){if(!t)return!1;try{let o=t.split(","),i=null;return o.find(r=>{let a=(0,qo.default)(r);return a.length?(i=a[0],!0):!1}),i}catch{return!1}}getPromoCodeEl(t){let o=t?.promoInputSelector;return this.getElement(o)}setValue(t,o){try{Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value")?.set?.call(t,o);let r=new Event("input",{bubbles:!0});t.dispatchEvent(r)}catch{t.value=o}}async getXhrMonitor(t,o,i){let r=K(t);return!this.hasFeature("ext_fast_roo_totals")||o&&this.hasFeature("ext_fast_roo_totals_no_auto")||i&&this.hasFeature("ext_fast_roo_totals_no_reload")||(o||i)&&this.hasFeature("ext_fast_roo_totals_no_reload_no_auto")?r:De(this._xhrQuietMonitor$)}async getTotal(t,o){let i,r,a;o&&({auto:i,isInitialTotal:r,isFinalTotal:a}=o);let n=(r||a)&&i?0:t.getTotalDelay;return await $o.default.race([this.waitForTotalChange(t.cartTotalSelector,!!t.useInnerText,n),K(n),this.getXhrMonitor(n,!!o?.auto,t.reload)]),this.getElement(t.removeErrorAction)&&await this.removeErrors(t),this.getCartTotal(t.cartTotalSelector,!!t.useInnerText)}async waitForTotalChange(t,o=!1,i=1e4){let r=new Date().getTime(),a=this.getElement(t),n=0,s;for(a&&(s=Me(o?a.innerText:a.innerHTML));!s&&n<i;)await K(20),a&&(s=Me(o?a.innerText:a.innerHTML)),n=new Date().getTime()-r;let c=s;for(;s===c&&n<i;)await K(20),a&&(s=Me(o?a.innerText:a.innerHTML)),n=new Date().getTime()-r;return s}async getCodeEntered(t){return t.useCodeEntered&&t.codeEnteredAction?!!this.getElement(t.codeEnteredAction):!1}click(t){try{let o=this.getElement(t);return o?(o.click(),!0):!1}catch{return!1}}removeElement(t){return t.parentNode?.removeChild(t)}async runCode(t){let o=document.createElement("script");o.textContent=t,(document.head||document.documentElement).appendChild(o),o.remove()}async writeCode(t,o){let i=this.getPromoCodeEl(t);i&&(i.contentEditable==="true"&&(i.textContent=""),this.setValue(i,""),await Wo(i,o))}async removePrevious(t,o){let i=t.promoRemoveAction;if(this.getElement(i)||o){this.click(i);let a=t.postRemoveDelay;return a&&await K(a),!0}return!1}async preApplyAction(t){let o=t.skipPreApplyAction;if(this.getElement(o))return;let r=t.preApplyAction;if(r&&r.length){this.click(r);let a=t.preApplyDelay;a&&await K(a)}}async removeErrors(t){let o=t.removeErrorAction;if(o){let i=this.getElement(o);i&&this.removeElement(i)}}async applyCode(t,o){if(!o)return;await this.removeErrors(t),await this.preApplyAction(t),await this.writeCode(t,o);let i=t.promoApplyAction;return setTimeout(()=>{this.click(i)},1),{code:o}}async getDiscount(t){if(!t.discountSelector)return null;let o=t.getTotalDelay;await $o.default.race([this.waitForTotalChange(t.discountSelector,!!t.useInnerText,o),K(o)]);let i=this.getElement(t.discountSelector);if(!i)return null;let r=Me(t.useInnerText?i.innerText:i.innerHTML);return isNaN(r)?null:r}getCartTotal(t,o=!1,i){if(!t)return;let r=Array();t.split(",").forEach(c=>{(0,qo.default)(c).toArray().forEach(m=>{let u=Me(o?m.innerText:m.innerHTML,i);r.push(u)})});let a,n=500,s=5e3;for(;!a&&n>=0;)a=r.find(c=>c>=n&&c<s),n-=50,s+=1e4;return!a&&a!==0&&(a=r.find(c=>Number(c))),a}getRooPreapplieds(t){if(t&&t.pageData&&t.pageData.products){let i=(t.pageData.products??[]).reduce((r,a)=>(a.coupon&&r.push({code:a.coupon}),r),Array());if(i&&i.length>0)return i}return null}async isCouponPage(t){let o=new ct,i=Fo(this.sendShoppingEvent),r=(0,ln.exponential)({randomisationFactor:0,initialDelay:50,maxDelay:3e3});return r.on("ready",()=>{try{let a=this.getCartTotal(t.cartTotalSelector,!!t.useInnerText,i),n=(t?.showCouponsSelector??"").trim().length?this.getElement(t.showCouponsSelector):!0;this.getPromoCodeEl(t)&&a&&n?o.next(!0):r.backoff()}catch(a){let n=a?.message;n!=="Backoff in progress."&&this.sendShoppingEvent("track","isCouponPageError",{error:n})}}),this.hasFeature("ext_coupons_skip_cashback_fallback")&&(r.failAfter(5),r.on("fail",()=>{this.onIsNotCouponPage(),o.next(!1)})),r.backoff(),De(o)}};function Ko(e){if(e&&!e.includes("-")){let t=e.split("");return[20,16,12,8].forEach(o=>t.splice(o,0,"-")),t.join("")}return e}var Vo=class{constructor(t,o){this._tryingCodes=!1;this.sendShoppingEvent=(t,...o)=>{};this.currentDomain=()=>"";this.activateInPinnedTab=t=>new Promise(()=>{});this.getSingleUseCouponsIfValid=(t,o,i)=>new Promise(()=>{});this.siteCache=t=>new Promise(()=>({}));this.handleResult=t=>new Promise(()=>{});this.shouldCouponsStandDown=()=>!1;this.compStateCache=t=>new Promise(()=>!1);this.domainLocalStorageGet=t=>new Promise(()=>null);this.domainLocalStorageSet=(t,o)=>new Promise(()=>{});this.domainLocalStorageRemove=t=>new Promise(()=>{});this.getFromState=t=>null;this.setInState=(t,o)=>{};this.onIsNotCouponPage=()=>{};this.onTryCode=t=>{};this.disableAffiliate=()=>{};this.setRunning=t=>{};this.startDeweyRun=()=>new Promise(()=>{});this.hasFeature=t=>!1;this.tryCodes=async({disableAffiliate:t,ignoreCancelled:o,coupons:i,automaticCouponsRun:r,autoFallback:a,isSiteHub:n,isCouponsImmediate:s,passedInClickId:c,couponRunId:l,cashback:m})=>{this._tryingCodes=!0;let u=c||(0,pn.v4)().replace(/-/g,""),f=this.currentDomain();t||await this.activateInPinnedTab(u);let{hash:w,host:v,hostname:y,href:h,origin:g,pathname:k,port:$,search:z}=window.location;this.sendShoppingEvent("track","tryCoupons",{clickId:u,redirectId:Ko(u),couponRunId:l,cashback:m,triggerType:We({automaticCouponsRun:r,autoFallback:a,isSiteHub:n,isCouponsImmediate:s}),couponScriptType:"roo",currentLocation:{hash:w,host:v,hostname:y,href:h,origin:g,pathname:k,port:$,search:z}}),(a||n)&&sessionStorage.setItem("__r_reload_auto","true");let A=await this.siteCache(f),T=this.getFromState(["userCouponChecks",f]);await this.startDeweyRun();let D=new Date().getTime(),I=A?.siteData?.coupons?.script,X=await this.getSingleUseCouponsIfValid(f,A,T);X&&X.length>0&&(i.pop(),i=i.concat(structuredClone(X)));let Se=this.dom.getRooPreapplieds(this.getFromState("deweyResult")||{})??[],me=structuredClone(i);if(!r&&Array.isArray(Se)&&(me=i.concat(Se),me=Ho(me,Ee=>Ee.code?.toLowerCase())),!await this._sendMessage({action:"init",ignoreCancelled:a||o,coupons:me,script:I,store:{cashback:m,clickId:u,couponRunId:l,isSiteHub:n,isCouponsImmediate:s,automaticCouponsRun:r,autoFallback:a,couponStartTime:D}})){console.error("Run failed to init");return}let ze=await this._sendMessage({action:"next"});if(!ze||!I)return;let Ue=new Date().getTime();!r&&I.initialAction?(await this.dom.click(I.initialAction),I.initialActionDelay&&await K(I.initialActionDelay)):!r&&I.disableInitialPromoRemove!==!0&&I.promoRemoveAction&&this.dom.getElement(I.promoRemoveAction)&&(await this.dom.click(I.promoRemoveAction),I.postRemoveDelay&&await K(I.postRemoveDelay));let St=new Date().getTime()-Ue||0;await this._sendMessage({action:"initialAction",initialActionTime:St});let _=await this.runner(ze);_&&(sessionStorage.getItem("__r_reload_auto")&&sessionStorage.removeItem("__r_reload_auto"),_.automaticCouponsRun=r,_.autoFallback=a,_.isSiteHub=n,_.isCouponsImmediate=s,_.couponRunId=l,_.cashback=m,_.originalCoupons=i,_.preappliedCodes=Se,_.couponScriptType="roo",I.useCodeEntered&&_.codeEntered&&!_.savings&&(_.requiresInput=I.codeEnteredAction?!!this.dom.getElement(I.codeEnteredAction):!0),_.startTime=D,_.duration=new Date().getTime()-D,this.determineSavingsClaimPreapplieds(_)||(_.savings=0),await this.handleResult({result:_,clickId:u})),this._tryingCodes=!1};this.initCoupons=async()=>{let t=null;this.setInState(["couponView","rooIsCheckingForCouponPage"],!0),this.setInState(["couponView","rooIsCouponPage"],!1);let o=this.currentDomain(),i=await this.siteCache(o),r=i?.siteData?.coupons??{},{script:a,coupons:n,ignoreAffiliate:s}=r,c=this.getFromState("tabId");(s||this.getFromState(["couponsAffiliateDisabledSites",`${o}_${c}`])>je(new Date)||this.getFromState(["couponsAffiliateDisabledSites",`${o}_all`])>je(new Date))&&this.disableAffiliate();let l=await this.dom.isCouponPage(r.script);if(this.setInState(["couponView","rooIsCheckingForCouponPage"],!1),this.setInState(["couponView","rooIsCouponPage"],l),!l)return;let m=this.shouldCouponsStandDown(),u=this.dom.getRooPreapplieds(this.getFromState("deweyResult")),f={coupons:n,preappliedCodes:u,standDown:m,roo:!0,estimatedRunTime:25e3,runTimePerCoupon:(a.getTotalDelay||0)+(a.preApplyDelay||0)+(a.postRemoveDelay||0),couponCount:n.length,disableAffiliate:s,affiliateLinkCurrentTab:i?.meta?.affiliate_link_current_tab,autoCoupConfig:i?.siteData?.coupons?.config?.auto_coup};this.hasFeature("user_contributed_codes")&&await this.setupCouponListener(a),await this._sendMessage({action:"pageLoad"});let w=await this._sendMessage({action:"next"});if(w){if(this._tryingCodes=!0,w.action==="cancelled")return;let v=await this._sendMessage({action:"nextCode"});Object.assign(f,{disableDelay:!!v,rooRunning:!0,currentCouponCode:v}),this.setInState("couponsConfig",f),t=f,(async()=>{let h=await this.runner(w);if(h){a.useCodeEntered&&h.codeEntered&&!h.savings&&(h.requiresInput=a.codeEnteredAction?!!this.dom.getElement(a.codeEnteredAction):!0);let{clickId:g,couponRunId:k,isSiteHub:$,isCouponsImmediate:z,automaticCouponsRun:A,autoFallback:T,cashback:D,couponStartTime:I}=h.store;h.isSiteHub=$,h.isCouponsImmediate=z,h.automaticCouponsRun=A,h.autoFallback=T,h.couponRunId=k,h.originalCoupons=n,h.preappliedCodes=u,h.couponScriptType="roo",h.cashback=D,h.startTime=I,h.duration=h.runTime,this.determineSavingsClaimPreapplieds(h)||(h.savings=0),await this.handleResult({result:h,clickId:g})}await this.domainLocalStorageGet("rooReloading")&&await this.domainLocalStorageRemove("rooReloading"),sessionStorage.getItem("__r_reload_auto")&&sessionStorage.removeItem("__r_reload_auto"),this.setRunning(!1)})()}else this.sendShoppingEvent("track","couponCheck"),this.setInState("couponsConfig",f),t=f;return t};Object.assign(this,o),this.dom=new ao(t,{onIsNotCouponPage:this.onIsNotCouponPage,sendShoppingEvent:this.sendShoppingEvent,hasFeature:this.hasFeature})}async _sendMessage(t){if(!this._msgListener$)throw new Error("No message listener added for RooClient");let o=new ct;return this._msgListener$.next({msg:t,sender:o}),De(o)}addListener(t){this._msgListener$=new ct,this._msgListener$.subscribe(({msg:o,sender:i})=>{t(o).then(r=>{i.next(r)})})}async cancel(){this.sendShoppingEvent("track","rooCancelled",{url:document.URL}),await this._sendMessage({action:"cancel"}),this._tryingCodes=!1}determineSavingsClaimPreapplieds(t){let{originalCoupons:o,bestCoupon:i,preappliedCodes:r}=t;return i&&r?!!o.find(a=>a.code?.toLowerCase()===i.code?.toLowerCase()):!0}async runner(t){let{script:o}=t;this._tryingCodes=!0,t.aggApplyCodeTime??=0,t.aggGetTotalTime??=0,t.aggRemovePreviousTime??=0,t.aggWaitForReloadTime??=0;try{if(t.action==="tryCode"){!t.applyingBestCode&&t.code&&this.onTryCode(t.code);let r,a=0;if(t.applyingBestCode&&t.auto&&t.code)r={code:t.code};else if(o){let n=new Date().getTime();r=await this.dom.applyCode(o,t.code);let s=new Date().getTime()-n;a=t.aggApplyCodeTime+s}await this._sendMessage({action:"saveCoupon",coupon:r,aggApplyCodeTime:a})}else if(t.action==="getDiscount"&&o){let r=new Date().getTime(),a=await this.dom.getDiscount(o)??void 0,n=new Date().getTime()-r,s=t.aggGetTotalTime+n;await this._sendMessage({action:"saveDiscount",discount:a,aggGetTotalTime:s})}else if(t.action==="getTotal"&&o){let r=new Date().getTime(),a=await this.dom.getTotal(o,t.options),n=new Date().getTime()-r,s=t.aggGetTotalTime+n;await this._sendMessage({action:"saveTotal",total:a,aggGetTotalTime:s})}else if(t.action==="codeEntered"&&o){let r=await this.dom.getCodeEntered(o);await this._sendMessage({action:"saveCodeEntered",codeEntered:r})}else if(t.action==="removePrevious"&&o){let r=new Date().getTime();await this.domainLocalStorageSet("rooReloading",!0);let a=await this.dom.removePrevious(o,t.lastCodeHadSavings),n=new Date().getTime()-r,s=t.aggRemovePreviousTime+n;await this._sendMessage({action:"codeRemoved",removed:a,aggRemovePreviousTime:s})}else{if(t.action==="finish")return this._tryingCodes=!1,t.result;if(t.action==="error")throw this._tryingCodes=!1,new Error(t.error?.message);if(t.action==="cancelled"){this._tryingCodes=!1;return}else if(t.action==="wait"){let r=new Date().getTime();await this.domainLocalStorageSet("rooReloading",!0),await K(1e4);let a=new Date().getTime()-r,n=t.aggWaitForReloadTime+a;await this._sendMessage({action:"pageLoad",aggWaitForReloadTime:n})}}let i=await this._sendMessage({action:"next"});return i?this.runner(i):void 0}catch(i){let r=i.stack?.split(`
`);this.sendShoppingEvent("track","rooError",{message:(r[0]+r[1]).match(/(.*)\s\(/)[1],url:document.URL}),sessionStorage?.removeItem("ogPageData"),await this._sendMessage({action:"error"})}}async setupCouponListener(t){try{if(t.promoApplyAction){let o=this.dom.getElement(t.promoApplyAction);o&&o.addEventListener("click",async r=>{await this.sendCustomerCodeEvent(t)});let i=this.dom.getPromoCodeEl(t);i&&i.addEventListener("keydown",async r=>{if(r.code==="Enter"){let a=this.sendCustomerCodeEvent.bind(t);jo(a,200)}})}}catch{}}async sendCustomerCodeEvent(t){if(!this._tryingCodes){let o=this.dom.getPromoCodeEl(t);if(o){let i=o?.value;if(i?.length){let r="userContributedCode";await this.compStateCache({action:"getHoneyState",comp:"honey"})&&(r="userContributedCodeH"),this.sendShoppingEvent("track",r,{code:i})}}}}};var Yo=p(Z()),Xo=p(Do());Mi();function fn(){let e=Gi("ext_sd_tld")?S():(0,Xo.getDomain)(location.href),t=d.get("tabId");return{domain:e,tabId:t,sameTabKey:`${e}_${t}`,allTabsKey:`${e}_all`}}function un(e,t){let{domain:o,tabId:i,sameTabKey:r,allTabsKey:a}=fn(),n=d.get([e,r]),s=d.get([e,a]),c=Dt(),l=n>c,m=s>c;return l||m}function dn(){return un("couponsDisabledSites","coupons")}function mn(){return un("cashbackDisabledSites","cashback")}function hn(){let e=(0,Xo.getDomain)(location.href);return d.get(["mitDisabledSites",e])}var gn=Yo.default.debounce(()=>{let{sameTabKey:e,allTabsKey:t}=fn(),o=d.get(["standDownReasons",e])||d.get(["standDownReasons",t]);x("track","standDownIndicator",{reason:o,url:location.href})},5e3,{leading:!0,trailing:!1}),bn=Yo.default.debounce(()=>{x("track","standDownIndicator",{reason:"mit",url:location.href})},5e3,{leading:!0,trailing:!1});Et();var de=p(Z()),Ei=p(Dc());Hc();Mi();Gc();var Zo=async e=>N("activatePinnedTab",e);var no=e=>N("competitorCashbackCacheGet",{domain:S(),comp:e});var ht=e=>N("competitorCashbackCacheRemove",{domain:S(),comp:e});var yn=e=>N("completeTooltipSteps",{step:e});var Qo=(e,t)=>N("domainLocalStorageSet",{domain:S(),key:e,value:t});var xn=e=>N("getCashback",{fromSiteHub:e});var W=p(Z()),sc=p(Do());Fc();var zs=p(L()),Us=p(Vc()),vt=p(Ki()),R=p(Z());var so=()=>{let e=d.get("deweyResult","pageType");return N("dismissCashback",e)};var wn=e=>N("setSeenCashbackNotification",e);function _n(){return{left:void 0,right:320,translateX:"initial"}}var Cn=p(Z());Ri();Wc();var vn=p(L()),gt=p(Ki()),kn=p(Z());var G=p(b()),Jo=class extends vn.Component{constructor(...t){super(...t),this.state={hideNotification:!1}}componentDidMount(){x("track","extEmailConfirmation",{action:"displayed"})}render(){let{hideNotification:t}=this.state,{email:o}=kn.default.get(this.props,"session");return(0,G.jsx)("div",{className:t?"disabled email-confirmation-page":"email-confirmation-page",style:{top:"0",bottom:"auto",left:"auto",right:"0"},children:(0,G.jsx)(gt.Motion,{style:{opacity:(0,gt.spring)(t?0:1,{stiffness:180,damping:20}),y:(0,gt.spring)(t?!0?-100:100:0,{stiffness:180,damping:20})},children:({opacity:r,y:a})=>(0,G.jsxs)("div",{className:"email-confirmation-notification",style:{transform:`translate3d(0,${a}%,0)`,opacity:`${r}`},children:[(0,G.jsxs)("header",{children:[(0,G.jsx)(He,{}),(0,G.jsx)(Nt,{onClick:this.onClosePopup.bind(this)})]}),(0,G.jsxs)("section",{children:[(0,G.jsx)("h5",{style:{fontWeight:"600",color:"black"},children:"Please verify your email address so we can notify you when your rewards are ready to use!"}),(0,G.jsx)("br",{}),(0,G.jsxs)("h5",{children:["The email address associated with your account is"," ",(0,G.jsx)("span",{style:{fontWeight:"bold",color:"black"},children:o})]}),(0,G.jsx)("div",{className:"button-wrapper",children:(0,G.jsx)("button",{className:"primary-btn-large",onClick:this.onConfirm.bind(this),children:"Confirm"})}),(0,G.jsx)("div",{className:"link-wrapper",children:(0,G.jsx)("a",{className:"not-your-email-link",href:"https://capitaloneshopping.com/help",target:"_blank",rel:"noopener noreferrer",onClick:this.onNotYourEmailClicked.bind(this),children:"Not your email?"})})]})]})})})}async onClosePopup(){await pt({message:"dismiss"}),x("track","extEmailConfirmation",{action:"dismiss"}),d.set("emailConfirmationVisible",!1),this.setState({hideNotification:!0})}async onConfirm(){await pt({message:"confirm"}),x("track","extEmailConfirmation",{action:"confirm"}),d.set("emailConfirmationVisible",!1),this.setState({hideNotification:!0})}async onNotYourEmailClicked(){x("track","extEmailConfirmation",{action:"notYourEmail"})}},ei=Fe({session:["session"]},Jo);var Sn=p(b());async function bt(){await Ad()&&(Rt({appName:"emailConfirmation",cssUrl:"cashback.css",app:(0,Sn.jsx)(ei,{})}),d.set("emailConfirmationVisible",!0))}async function Ad(){if(d.get("emailConfirmationVisible")||!O("email_unengaged"))return!1;let e=await pt({message:"getEvents"}),t=Cn.default.chain(e).pickBy(n=>new Date-new Date(n)<ji).value();if("hasConfirmedEmail"in t&&new Date-new Date(t.hasConfirmedEmail)<6048e5)return!1;let i="seenEmailConfirmation1"in t&&"seenEmailConfirmation2"in t&&"seenEmailConfirmation3"in t,r=new Date(Math.max(new Date(t.seenEmailConfirmation1||0),new Date(t.seenEmailConfirmation2||0),new Date(t.seenEmailConfirmation3||0))),a=r&&new Date-r<864e5;return!(i||a)}Ri();var Tn=e=>N("hasDismissedAnyNotification",e);var En=(e,t,o)=>N("setNotificationEvent",{event:e,type:t,subType:o});function Dn(e,t){En(Pi,e,t)}function vk(){return Tn(864e5)}function ue(e,t,o,i,{redirect:r=!1,cashback:a=!1,...n}={}){let s,c;if(window.__wb_contentId){switch(e){case"cashbackNotification":s="cashback";break;case"couponNotification":case"couponNotificationResult":s="coupons";break;case"siteHubOffers":s="sitehub";break}s&&(c=window.__wb_contentId[s])}x("track","desktopExtensionClick",{name:e,label:t?.toLowerCase(),type:o,subType:i,cashback:a,redirect:r,...n,contentId:c})}var Un=p(L()),Le=p(Z());var In=p(L()),yt=p(Z());var B=p(b()),oi=class extends In.Component{constructor(t){super(t),this.state={expanded:!1}}toggleContainerSize(t){t.preventDefault(),this.setState({expanded:!this.state.expanded})}onShowExclusion(){x("trackClick","viewExclusionDetails","view details"),window.open(`${q}/s/${this.props.tld}/coupon`,"_blank")}render(){let{expanded:t}=this.state,{center:o,couponCount:i,displayInModal:r,hasCoupons:a,reward:n,runTimeSeconds:s,showCouponCount:c,showDismiss:l,showReward:m}=this.props,u=m?n.type==="percentage"?`${n.amount/100}%`:ee(n.amount,{currency:n.amountCurrency||n.currency}):"",f=3,w=n&&yt.default.get(n,"categories.length",0)>f,v=yt.default.get(n,"categories")||[],y=t?v:v.slice(0,f);return n.categories?(0,B.jsxs)("div",{className:`simple-section ${o?"center":""} ${r?"display-in-modal":""}`,children:[m&&(0,B.jsxs)("div",{className:"reward-text",children:[(0,B.jsxs)("h2",{children:["Up to ",(0,B.jsx)("span",{className:"palmetto",children:u})," in Rewards Activated"]}),c&&(0,B.jsxs)("h6",{className:"bold center",children:[i," ",i===1?" code ":" best codes "," tested in"," ",s," sec."]}),(0,B.jsxs)("h6",{className:"exclusion-text center",children:["*Rewards may vary based on exchange rates. Terms and exclusions apply",yt.default.get(this.props,"view.exclusions")?(0,B.jsxs)(B.Fragment,{children:[","," ",(0,B.jsx)("span",{className:"tertiary-link-lighter",onClick:this.onShowExclusion.bind(this),children:"view details."})]}):null]})]}),(0,B.jsxs)("div",{className:"reward-categories",children:[(0,B.jsx)("h5",{className:"bold",children:"Rewards by Category"}),(0,B.jsxs)("div",{className:`cashback-category-section ${a&&"show-border"}`,children:[(0,B.jsx)("div",{className:"cashback-category-container",children:yt.default.map(y,({name:h,amount:g,type:k})=>(0,B.jsxs)("div",{className:"cashback-category-row",children:[(0,B.jsx)("p",{className:"cashback-category-name",children:h}),(0,B.jsx)("span",{className:"cashback-category-reward",children:k==="percentage"?`${g/100}%`:ee(g)})]},h))}),w&&(0,B.jsxs)("h5",{className:"toggle-container-cta",onClick:this.toggleContainerSize.bind(this),children:["Show ",this.state.expanded?"fewer":"all"," categories"]})]})]}),l&&(0,B.jsx)("div",{className:"dismiss-notif",children:(0,B.jsx)("h4",{className:"primary-link bold",onClick:this.props.onClosePopup.bind(this),children:"Continue to Checkout"})})]}):null}},ii=oi;var Je=p(L());var co=p(b());function Nd({style:e,flex:t,width:o=40,height:i=25,color:r="#adb9bf",onClick:a,marginTop:n=0,marginRight:s,marginLeft:c}){return(0,co.jsx)("div",{style:{...e,display:"flex",flex:t,justifyContent:"right",alignItems:"center",width:o,height:i,color:r,marginTop:n,marginRight:s,marginLeft:c},onClick:a,children:(0,co.jsx)("svg",{width:"28",height:"29",viewBox:"0 0 28 29",fill:"none",style:{cursor:"pointer"},"aria-label":"Settings",role:"button",xmlns:"http://www.w3.org/2000/svg",children:(0,co.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25.9952 15.1504L23.019 18.1266V22.3506C23.019 22.9802 22.5039 23.4953 21.8743 23.4953H17.6389L14.6627 26.4715C14.2163 26.9179 13.4951 26.9179 13.0487 26.4715L10.0725 23.4953H5.84855C5.21896 23.4953 4.70385 22.9802 4.70385 22.3506V18.1152L1.72765 15.139C1.28121 14.6926 1.28121 13.9714 1.72765 13.525L4.70385 10.5488V6.32485C4.70385 5.69527 5.21896 5.18015 5.84855 5.18015H10.0725L13.0601 2.20395C13.274 1.9896 13.5643 1.86914 13.8671 1.86914C14.1699 1.86914 14.4603 1.9896 14.6741 2.20395L17.6503 5.18015H21.8743C22.5039 5.18015 23.019 5.69527 23.019 6.32485V10.5488L25.9952 13.5364C26.4416 13.9829 26.4416 14.704 25.9952 15.1504ZM6.99317 14.3379C6.99317 18.1268 10.0724 21.2061 13.8613 21.2061C17.6503 21.2061 20.7295 18.1268 20.7295 14.3379C20.7295 10.549 17.6503 7.46973 13.8613 7.46973C10.0724 7.46973 6.99317 10.549 6.99317 14.3379Z",fill:"#B4BDC2"})})})}var ri=Nd;var V=p(b());function Md(e){let[t,o]=(0,Je.useState)(!1),i=n=>{let s=(0,Je.useRef)();return(0,Je.useEffect)(()=>{let c=()=>{n()};return document.addEventListener("click",c,!0),()=>{document.removeEventListener("click",c,!0)}},[s]),s},r=()=>{setTimeout(()=>{o(!1)})};return(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)("div",{style:{width:48},children:(0,V.jsx)(ri,{onClick:()=>o(!t),style:{position:"fixed",top:14,right:15}})}),t?(0,V.jsx)(()=>(0,V.jsx)("div",{ref:i(r),className:"notification-menu",children:(0,V.jsxs)("ul",{children:[(0,V.jsx)("li",{children:(0,V.jsx)("p",{onClick:e.confirmDismiss,className:"menu-item",children:"Dismiss Notification"})}),(0,V.jsx)("li",{children:(0,V.jsx)("p",{onClick:e.snoozeNotification,className:"menu-item",children:"Snooze for 24 Hours"})})]})}),{}):null]})}var ai=Md;var An=e=>()=>{e("Snooze for 24 Hours")},lo=(e,t,o,i,r)=>{e.stopPropagation(),i?(o(t,!0),x("trackClick","dismissCompetitorClickWarning",t,{rewardAmount:r?.amount,rewardDisplay:r?.type})):o(t)};var Nn=p(b()),po=({onUserClosePopup:e})=>e?(0,Nn.jsx)(ai,{confirmDismiss:()=>e("Dismiss Notification"),snoozeNotification:An(e)}):null;var ne=p(b());function Pd(){x("trackClick","viewExclusionDetails","view details"),window.open(`${q}/s/${S()}/coupon`,"_blank")}function ni({reward:e,containerStyle:t}){if(e?.type!=="threshold"&&!e?.threshold)return null;let o=d.get(["siteAPIData","siteData","merchantPage","exclusions"]);return(0,ne.jsx)("div",{style:t,children:(0,ne.jsx)(ar,{side:"left",text:"*Terms and Conditions Apply",hoverTitle:"This limited time offer is available for one use only.",hoverText:(0,ne.jsxs)(ne.Fragment,{children:["The spend requirement must be met in a single transaction, on non-excluded items, after discounts, store credits, and redemption dollars are applied, and before taxes and shipping fees are applied.",o&&(0,ne.jsxs)(ne.Fragment,{children:[" ","Exclusions apply,"," ",(0,ne.jsx)("span",{className:"tertiary-link-lighter",onClick:Pd,children:"view details"}),"."]})]})})})}var Pn=p(zi());var fo=p(L());var Rd=["data:image/jpeg;base64,","data:image/png;base64,","data:image/webp;base64,"];async function si(e){try{let t=await fetch(e).then(i=>i.blob());return await new Promise(i=>{let r=new window.FileReader;r.onload=()=>{let a=r.result,n=!!a&&Rd.some(s=>a.startsWith(s));i(n?a:null)},r.readAsDataURL(t)})}catch{return null}}function xt(e){let[t,o]=(0,fo.useState)("");return(0,fo.useEffect)(()=>{async function i(){o(await si(e))}e&&i()},[e]),t}var C=p(b()),f0="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI5IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDE1OSAxNTgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3R5bGU9ImhlaWdodDomcXVvdDsxMDAlJnF1b3Q7Ij48ZyBmaWxsPSJub25lIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxLjUwOSAuNTk2KSI+PG1hc2sgaWQ9ImEiIGZpbGw9IiNmZmYiPjxwYXRoIGQ9Ik0uMDE2LjE1OGgxNTYuNzI4djE1Ni43MjlILjAxNnoiLz48L21hc2s+PHBhdGggZD0iTTE1Ni43NDQgNzguNTIyYzAgNDMuMjgtMzUuMDg1IDc4LjM2NS03OC4zNjQgNzguMzY1Uy4wMTYgMTIxLjgwMi4wMTYgNzguNTIyQy4wMTYgMzUuMjQ0IDM1LjEwMS4xNTggNzguMzguMTU4czc4LjM2NCAzNS4wODYgNzguMzY0IDc4LjM2NCIgZmlsbD0iI0U4RTlFOSIgbWFzaz0idXJsKCNhKSIvPjwvZz48bWFzayBpZD0iYiIgZmlsbD0iI2ZmZiI+PHBhdGggZD0iTTAgMTU3LjQ4M2gxNTguMjUzVi43NTRIMHoiLz48L21hc2s+PHBhdGggZmlsbD0iIzM5QjQ0OSIgbWFzaz0idXJsKCNiKSIgZD0iTTIxLjExNCA5OS42NTZIMTM5LjUyVjM3LjE4NEgyMS4xMTR6Ii8+PHBhdGggc3Ryb2tlPSIjMTc3QzNFIiBtYXNrPSJ1cmwoI2IpIiBkPSJNMjcuMDggOTQuMzE0aDEwNi40NzRWNDMuMTE3SDI3LjA4eiIvPjxwYXRoIGQ9Ik0yNy4wOCA4MS40ODF2MTIuODMzaDEyLjgzNGMwLTcuMDg4LTUuNzQ2LTEyLjgzMy0xMi44MzQtMTIuODMzbTEyLjgzNC0zOC4zNjRIMjcuMDhWNTUuOTVjNy4wODkgMCAxMi44MzQtNS43NDUgMTIuODM0LTEyLjgzM205My42NCAxMi44MzNWNDMuMTE2SDEyMC43MmMwIDcuMDg4IDUuNzQ2IDEyLjgzNCAxMi44MzQgMTIuODM0bS0xMi44MzMgMzguMzY0aDEyLjgzM1Y4MS40OGMtNy4wODggMC0xMi44MzMgNS43NDYtMTIuODMzIDEyLjgzNE05Ni4xNTMgNjguNDJjMCA5Ljk2My03LjA5IDE4LjA0LTE1LjgzNiAxOC4wNHMtMTUuODM1LTguMDc3LTE1LjgzNS0xOC4wNCA3LjA5LTE4LjA0IDE1LjgzNS0xOC4wNGM4Ljc0NyAwIDE1LjgzNiA4LjA3NyAxNS44MzYgMTguMDRtLTc1LjAzOSAzNC41NjZIMTM5LjUydi0zLjMzSDIxLjExNHoiIGZpbGw9IiMxNzdDM0UiIG1hc2s9InVybCgjYikiLz48cGF0aCBmaWxsPSIjMzlCNDQ5IiBtYXNrPSJ1cmwoI2IpIiBkPSJNMjEuMTE0IDEwNi4zMTVIMTM5LjUydi0zLjMzSDIxLjExNHoiLz48cGF0aCBmaWxsPSIjMTc3QzNFIiBtYXNrPSJ1cmwoI2IpIiBkPSJNMjEuMTE0IDEwOS42NDVIMTM5LjUydi0zLjMzSDIxLjExNHoiLz48cGF0aCBmaWxsPSIjMzlCNDQ5IiBtYXNrPSJ1cmwoI2IpIiBkPSJNMjEuMTE0IDExMi45NzRIMTM5LjUydi0zLjMyOUgyMS4xMTR6Ii8+PHBhdGggZmlsbD0iIzE3N0MzRSIgbWFzaz0idXJsKCNiKSIgZD0iTTIxLjExNCAxMTYuMzA0SDEzOS41MnYtMy4zM0gyMS4xMTR6Ii8+PHBhdGggZmlsbD0iIzM5QjQ0OSIgbWFzaz0idXJsKCNiKSIgZD0iTTIxLjExNCAxMTkuNjMzSDEzOS41MnYtMy4zM0gyMS4xMTR6Ii8+PHBhdGggZmlsbD0iIzE3N0MzRSIgbWFzaz0idXJsKCNiKSIgZD0iTTIxLjExNCAxMjIuOTYySDEzOS41MnYtMy4zM0gyMS4xMTR6Ii8+PHBhdGggZmlsbD0iIzM5QjQ0OSIgbWFzaz0idXJsKCNiKSIgZD0iTTIxLjExNCAxMjYuMjkySDEzOS41MnYtMy4zM0gyMS4xMTR6Ii8+PHBhdGggZmlsbD0iI0YyRjJGMiIgbWFzaz0idXJsKCNiKSIgZD0iTTczLjA1MyA5OS42NTZIODcuNThWMzcuMTg0SDczLjA1M3oiLz48cGF0aCBmaWxsPSIjQzZDNkM1IiBtYXNrPSJ1cmwoI2IpIiBkPSJNNzMuMDUzIDEyNi4yOTJIODcuNThWOTkuNjU2SDczLjA1M3oiLz48cGF0aCBmaWxsPSIjRTU5NTM0IiBtYXNrPSJ1cmwoI2IpIiBkPSJNOC44NyAxMzEuMDEzaDI5LjMzMXYtNC44MDRIOC44NzF6Ii8+PHBhdGggZmlsbD0iI0ZBQjA0MiIgbWFzaz0idXJsKCNiKSIgZD0iTTIuOTgyIDEyNi4yMDloMjkuMzMxdi00LjgwNkgyLjk4M3oiLz48cGF0aCBmaWxsPSIjRTU5NTM0IiBtYXNrPSJ1cmwoI2IpIiBkPSJNMy4wOTggMTIxLjQwM2gyOS4zM1YxMTYuNkgzLjA5OXoiLz48cGF0aCBmaWxsPSIjRkFCMDQyIiBtYXNrPSJ1cmwoI2IpIiBkPSJNNS45MjYgMTE2LjU5OWgyOS4zMzF2LTQuODA2SDUuOTI3eiIvPjxwYXRoIGZpbGw9IiNFNTk1MzQiIG1hc2s9InVybCgjYikiIGQ9Ik0yLjk4MiAxMTEuNzk0aDI5LjMzMXYtNC44MDZIMi45ODN6Ii8+PHBhdGggZmlsbD0iI0ZBQjA0MiIgbWFzaz0idXJsKCNiKSIgZD0iTTAgMTA2Ljk4OGgyOS4zM3YtNC44MDRIMHoiLz48cGF0aCBmaWxsPSIjRTU5NTM0IiBtYXNrPSJ1cmwoI2IpIiBkPSJNNS45MjYgMTAyLjE4NGgyOS4zMzF2LTQuODA2SDUuOTI3eiIvPjxwYXRoIGZpbGw9IiNGQUIwNDIiIG1hc2s9InVybCgjYikiIGQ9Ik0yLjk0NCA5Ny4zNzhoMjkuMzN2LTQuODA0SDIuOTQ1eiIvPjwvZz48L3N2Zz4=";function Ld(){return(0,C.jsx)("svg",{width:"129px",height:"128px",viewBox:"0 0 159 158",version:"1.1",xmlns:"http://www.w3.org/2000/svg",style:{height:"100%"},children:(0,C.jsxs)("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",children:[(0,C.jsxs)("g",{transform:"translate(1.508527, 0.595868)",children:[(0,C.jsx)("mask",{id:"mask-2",fill:"white",children:(0,C.jsx)("polygon",{points:"0.0159903815 0.158395289 156.744206 0.158395289 156.744206 156.886611 0.0159903815 156.886611"})}),(0,C.jsx)("path",{d:"M156.744357,78.5224278 C156.744357,121.802055 121.659046,156.886611 78.3801738,156.886611 C35.1013011,156.886611 0.0159903815,121.802055 0.0159903815,78.5224278 C0.0159903815,35.2435551 35.1013011,0.158244436 78.3801738,0.158244436 C121.659046,0.158244436 156.744357,35.2435551 156.744357,78.5224278",fill:"#E8E9E9",mask:"url(#mask-2)"})]}),(0,C.jsx)("mask",{id:"mask-4",fill:"white",children:(0,C.jsx)("polygon",{points:"0 157.48263 158.252733 157.48263 158.252733 0.754263279 0 0.754263279"})}),(0,C.jsx)("polygon",{fill:"#39B449",mask:"url(#mask-4)",points:"21.114092 99.6562815 139.51985 99.6562815 139.51985 37.1844254 21.114092 37.1844254"}),(0,C.jsx)("polygon",{stroke:"#177C3E",strokeWidth:"3.852",mask:"url(#mask-4)",points:"27.0803145 94.3138347 133.554382 94.3138347 133.554382 43.1167061 27.0803145 43.1167061"}),(0,C.jsx)("path",{d:"M27.0803145,81.4809501 L27.0803145,94.3139856 L39.9141042,94.3139856 C39.9141042,87.2261735 34.1681266,81.4809501 27.0803145,81.4809501",fill:"#177C3E",mask:"url(#mask-4)"}),(0,C.jsx)("path",{d:"M39.9138779,43.1166307 L27.0800882,43.1166307 L27.0800882,55.9504204 C34.1686545,55.9504204 39.9138779,50.205197 39.9138779,43.1166307",fill:"#177C3E",mask:"url(#mask-4)"}),(0,C.jsx)("path",{d:"M133.554457,55.9501187 L133.554457,43.116329 L120.719913,43.116329 C120.719913,50.204141 126.465891,55.9501187 133.554457,55.9501187",fill:"#177C3E",mask:"url(#mask-4)"}),(0,C.jsx)("path",{d:"M120.720969,94.314061 L133.554005,94.314061 L133.554005,81.4802713 C126.466193,81.4802713 120.720969,87.226249 120.720969,94.314061",fill:"#177C3E",mask:"url(#mask-4)"}),(0,C.jsx)("path",{d:"M96.1528794,68.4205043 C96.1528794,78.3828137 89.0635589,86.4602192 80.3171219,86.4602192 C71.5714392,86.4602192 64.4821186,78.3828137 64.4821186,68.4205043 C64.4821186,58.4574407 71.5714392,50.3807895 80.3171219,50.3807895 C89.0635589,50.3807895 96.1528794,58.4574407 96.1528794,68.4205043",fill:"#177C3E",mask:"url(#mask-4)"}),(0,C.jsx)("polygon",{fill:"#177C3E",mask:"url(#mask-4)",points:"21.114092 102.9856 139.51985 102.9856 139.51985 99.6562815 21.114092 99.6562815"}),(0,C.jsx)("polygon",{fill:"#39B449",mask:"url(#mask-4)",points:"21.114092 106.314918 139.51985 106.314918 139.51985 102.9856 21.114092 102.9856"}),(0,C.jsx)("polygon",{fill:"#177C3E",mask:"url(#mask-4)",points:"21.114092 109.64499 139.51985 109.64499 139.51985 106.315672 21.114092 106.315672"}),(0,C.jsx)("polygon",{fill:"#39B449",mask:"url(#mask-4)",points:"21.114092 112.974308 139.51985 112.974308 139.51985 109.64499 21.114092 109.64499"}),(0,C.jsx)("polygon",{fill:"#177C3E",mask:"url(#mask-4)",points:"21.114092 116.303626 139.51985 116.303626 139.51985 112.974308 21.114092 112.974308"}),(0,C.jsx)("polygon",{fill:"#39B449",mask:"url(#mask-4)",points:"21.114092 119.632944 139.51985 119.632944 139.51985 116.303626 21.114092 116.303626"}),(0,C.jsx)("polygon",{fill:"#177C3E",mask:"url(#mask-4)",points:"21.114092 122.962263 139.51985 122.962263 139.51985 119.63219 21.114092 119.63219"}),(0,C.jsx)("polygon",{fill:"#39B449",mask:"url(#mask-4)",points:"21.114092 126.291581 139.51985 126.291581 139.51985 122.962263 21.114092 122.962263"}),(0,C.jsx)("polygon",{fill:"#F2F2F2",mask:"url(#mask-4)",points:"73.0526614 99.6562815 87.5812807 99.6562815 87.5812807 37.1844254 73.0526614 37.1844254"}),(0,C.jsx)("polygon",{fill:"#C6C6C5",mask:"url(#mask-4)",points:"73.0526614 126.291581 87.5812807 126.291581 87.5812807 99.6562815 73.0526614 99.6562815"}),(0,C.jsx)("polygon",{fill:"#E59534",mask:"url(#mask-4)",points:"8.87013617 131.013269 38.2011723 131.013269 38.2011723 126.208612 8.87013617 126.208612"}),(0,C.jsx)("polygon",{fill:"#FAB042",mask:"url(#mask-4)",points:"2.98235701 126.208612 32.3133932 126.208612 32.3133932 121.4032 2.98235701 121.4032"}),(0,C.jsx)("polygon",{fill:"#E59534",mask:"url(#mask-4)",points:"3.09775929 121.4032 32.4287954 121.4032 32.4287954 116.598543 3.09775929 116.598543"}),(0,C.jsx)("polygon",{fill:"#FAB042",mask:"url(#mask-4)",points:"5.92624659 116.598543 35.2572827 116.598543 35.2572827 111.793132 5.92624659 111.793132"}),(0,C.jsx)("polygon",{fill:"#E59534",mask:"url(#mask-4)",points:"2.98235701 111.793886 32.3133932 111.793886 32.3133932 106.988475 2.98235701 106.988475"}),(0,C.jsx)("polygon",{fill:"#FAB042",mask:"url(#mask-4)",points:"-0.000754263279 106.988475 29.3302819 106.988475 29.3302819 102.183818 -0.000754263279 102.183818"}),(0,C.jsx)("polygon",{fill:"#E59534",mask:"url(#mask-4)",points:"5.92624659 102.183818 35.2572827 102.183818 35.2572827 97.3784064 5.92624659 97.3784064"}),(0,C.jsx)("polygon",{fill:"#FAB042",mask:"url(#mask-4)",points:"2.94388958 97.3784064 32.2749257 97.3784064 32.2749257 92.5737493 2.94388958 92.5737493"})]})})}var Mn=Ld;var et=p(b()),Od=({domain:e,width:t=300,height:o=300})=>{let i=xt(`${At}?${Pn.default.stringify({domain:e,width:t,height:o})}`);return Wi()?(0,et.jsx)("div",{className:"partner-logo-component",children:i===null?(0,et.jsx)("div",{className:"partner-logo",children:(0,et.jsx)(Mn,{})}):i?(0,et.jsx)("div",{className:"partner-logo success",style:{backgroundImage:`url("${i}")`}}):(0,et.jsx)("div",{className:"partner-logo"})}):null},ci=Od;var se=p(b());function uo({reward:e}){if(!e?.tiers?.length)return null;let t={currency:e.amountCurrency||e.currency,truncateIntegers:!0};return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)("h3",{className:"bold mt-3",id:"threshold-tiers","aria-hidden":!0,children:"Rewards by Spend"}),(0,se.jsx)("ol",{"aria-labelledby":"threshold-tiers",children:e.tiers.map((o,i)=>{let r=i<e.tiers.length-1,a=`Spend ${ee(o.spendCents||o.spend_cents,t)?.replace(r?/[ A-Z]/g:"","")}${r?"-"+ee(e.tiers[i+1].spendCents||e.tiers[i+1].spend_cents,t):"+"}`,n=o.reward.type==="percentage"?`${o.reward.value/100}% back`:ee(o.reward.value,t);return(0,se.jsxs)("li",{className:"flex text-sm bold mt-2","aria-label":`${a}, earn ${n}`,children:[(0,se.jsx)("span",{className:"grow text-neutralsecondary","aria-hidden":!0,children:a}),(0,se.jsx)("span",{className:"shrink-0 whitespace-nowrap text-[#0276b1] pl-4","aria-hidden":!0,children:n})]},i)})})]})}var Rn=p(L());var Pe=p(b()),Bd=e=>e>160&&e<171?e:160;function zd(e){let[t,o]=(0,Rn.useState)(!1),i=Bd(e.exclusions.length),r=e.exclusions.length,a=e.exclusions.substring(0,i);return(0,Pe.jsxs)("div",{className:"website-exclusions",children:[(0,Pe.jsx)("h5",{className:"bold",children:"Exclusions Apply:"}),(0,Pe.jsx)("p",{children:t?e.exclusions:`${a}${r>i?"...":""}`}),r>i?(0,Pe.jsx)("div",{className:"exclusion-expand",children:(0,Pe.jsx)("span",{className:"exclusion-expand-text",onClick:()=>o(!t),children:t?"Collapse":"Expand"})}):null]})}var li=zd;var Bn=p(L()),zn=p(Z());function Re(e){return["wayfair.com","wayfair.ca","jossandmain.com","birchlane.com","allmodern.com","trade.wayfair.com","perigold.com"].includes(e)}var re=p(b()),Ud=({onDetailsClick:e,exclusions:t=!0,...o})=>S()==="quill.com"?(0,re.jsx)("p",{style:{color:"#a2adb4",fontSize:"12px",fontWeight:"normal",marginTop:"10px",lineHeight:"1.25em"},children:"*All HP, Epson, and Samsung products are excluded from coupons, discounts, and rewards offers."}):Re(S())?(0,re.jsx)("p",{style:{color:"#a2adb4",fontSize:"12px",fontWeight:"normal",marginTop:"10px",lineHeight:"1.25em"},children:"*Items in cart prior to rewards activation will not be eligible for rewards."}):(0,re.jsxs)("h6",{...o,children:[(0,re.jsx)("span",{style:{marginRight:"3px"},children:"*"}),(0,re.jsxs)("span",{children:["Rewards may vary based on exchange rates.",t&&(0,re.jsxs)(re.Fragment,{children:[" ","Terms and exclusions apply,",(0,re.jsxs)("span",{className:"tertiary-link-lighter",onClick:e,children:[" ","view details."]})]})]})]}),pi=Ud;var Ln=p(L()),On=p(Z());var ve=p(b()),fi=class extends Ln.Component{constructor(...t){super(...t),this.state={}}componentWillMount(){}componentDidMount(){this.props.isCreditsReminderMessage&&setTimeout(()=>{x("page","creditIgnoreTooltip",{view:"cashbackNotification",type:"tooltip"}),chrome.storage.local.set({seenCreditsReminder:Date.now()})},Number(this.props.delay.replace("ms","")))}getCtaButtonText(){let t;try{let o=d.get(["shadowRootsByAppName","notification"]);if(o){let i=o();i&&(t=i.querySelector(".primary-btn-large").textContent)}}catch{}return t}render(){let{tipLabel:t,message:o,isCreditsReminderMessage:i}=this.props,r=this.props.style||{};if(this.props.delay){let a={animationDelay:this.props.delay};r=On.default.merge(a,r)}return(0,ve.jsx)("div",{style:r,className:`new-tooltip ${this.props.position||""}${i?" credits-reminder":""}`,children:(0,ve.jsxs)("div",{style:this.props.innerStyle||{},onClick:this.props.onDismissTooltip.bind(this),className:"new-tooltip-wrapper",children:[(0,ve.jsx)("div",{className:"close icon-x"}),i?(0,ve.jsx)("div",{className:`triangle ${i?"credits-reminder":""}`}):null,(0,ve.jsxs)("h2",{children:[this.props.tip?(0,ve.jsx)("span",{className:"bold",children:t||"tip:"}):null,o]})]})})}},tt=fi;var ot=p(b());function jd(e,{capitalize:t=!0}={}){return e.type==="threshold"&&e.threshold?t?"Earn ":"earn ":t?"Get ":"get "}function Fd(e,{capitalizeUpTo:t=!1,hideUpTo:o=!1}={}){let i=!o&&(e.categories||e.estimated)?t?"Up to ":"up to ":"",r=e.tiers?.length?e.tiers[e.tiers.length-1].reward.type:e.type,a=e.tiers?.length?e.tiers[e.tiers.length-1].reward.value:e.amount,n=r==="percentage"?`${a/100}%`:ee(a,{currency:e.amountCurrency||e.currency,truncateIntegers:!0}),s="";if(e.maxPayoutAmount){let c=ee(e.maxPayoutAmount,{currency:e.maxPayoutAmountCurrency,truncateIntegers:!0});s+=` (${c} max)`}return i+n+s}function Hd(e){let t="";if(e.type==="threshold"&&e.threshold){let o=e.tiers?.length?e.tiers[e.tiers.length-1].spendCents||e.tiers[e.tiers.length-1].spend_cents:e.threshold,i=ee(o,{currency:e.amountCurrency||e.currency,truncateIntegers:!0});t.length>0&&(t+=","),t+=` when you spend ${i}`}return" back"+t}function mo(e,{hidePrefix:t=!1,hideSuffix:o=!1}={}){return(0,ot.jsxs)(ot.Fragment,{children:[!t&&jd(e),(0,ot.jsx)("span",{className:"brand",children:Fd(e)}),!o&&Hd(e)]})}var F=p(b()),ui=class extends Bn.Component{constructor(t){super(t),this.state={isLoggedIn:Ie()},this.ebatesComparisonSiteList=["macys.com","oakley.com","puritanspride.com","ebay.com","walmart.com","marriott.com","sephora.com","zulily.com","tirerack.com","ancestry.com","samsclub.com","samsung.com","nordvpn.com","priceline.com","qvc.com","microsoftstore.com","starwoodhotels.com","discounttire.com","officedepot.com","lifelock.com","omahasteaks.com","woot.com","coursera.org","sixt.com","wsj.com","gilt.com"]}componentWillReceiveProps(t){t.showCreditsReminder!==this.state.showCreditsReminder&&!this.state.didDismiss&&this.setState({showCreditsReminder:t.showCreditsReminder})}renderHeadline(){return(0,F.jsx)("h2",{children:mo(this.props.view.reward)})}render(){let o=!lt(S()),i=this.props.activating&&!this.state.hasClickedToLogin,r=this.props.activated&&!this.state.hasClickedToLogin,{reward:a,vendor:n}=this.props.view,s=i||r,c=a.amount/100>=5||!!a.categories,l="Ok";return(0,F.jsxs)("div",{className:"simple-section",children:[s?(0,F.jsxs)("h2",{children:["Activating ",mo(a,{hidePrefix:!0})]}):c?this.renderHeadline():(0,F.jsx)("h2",{children:"Found Rewards"}),(0,F.jsxs)("h4",{className:"bold",children:["at ",n,"."]}),(0,F.jsx)("div",{className:"button-wrapper",children:Ie()?(0,F.jsxs)(F.Fragment,{children:[this.renderControl(l),S()==="quill.com"||Re(S())?(0,F.jsx)(pi,{}):null,this.state.showCreditsReminder&&!(r||i)?(0,F.jsx)(tt,{tip:!0,isCreditsReminderMessage:!0,tipLabel:"Activating Shopping Rewards is completely free.",message:(0,F.jsx)("span",{className:"dismiss-text",children:"Click the \u201COk\u201D button to activate Rewards on your purchases that you can redeem for gift cards at top stores."}),delay:"7000ms",style:{top:"50%",transform:"translateY(-50%)",width:"360px",right:"calc(100% + 16px)"},onDismissTooltip:this.onDismissTooltip.bind(this)}):null]}):(0,F.jsx)("button",{className:`primary-btn-large ${o?"red-btn":""} ${O("notif_rounded_border")?"rounded-btn":""}`,onClick:this.onClickSignIn.bind(this),children:l})})]})}renderControl(t){let i=!lt(S()),r=this.props.activating&&!this.state.hasClickedToLogin;return this.props.activated&&!this.state.hasClickedToLogin?(0,F.jsx)("button",{className:`primary-btn-large ${O("notif_rounded_border")?"rounded-btn":""}`,disabled:!0,children:"Activated"}):r?(0,F.jsx)("button",{className:`primary-btn-large ${O("notif_rounded_border")?"rounded-btn":""}`,disabled:!0,children:"Activating"}):(0,F.jsx)("button",{className:`primary-btn-large ${i?"red-btn":""} ${O("notif_rounded_border")?"rounded-btn":""}`,onClick:n=>{n.stopPropagation(),this.props.onActivate({label:t})},children:t})}async onClickSignIn(t){t.stopPropagation(),this.setState({hasClickedToLogin:!0});let o=zn.default.get(this.props.view,"vendor"),i=await Lt();this.props.onActivate({preventHide:!this.state.hasClickedToLogin,shouldLoadEmailCreateAccountNotification:i}),x("track","signinRequired",{vendor:o}),i||window.open(`${q}/sign-in`)}},di=ui;var E=p(b()),mi=class extends Un.Component{constructor(t){super(t),this.state={}}onShowExclusion(){x("trackClick","viewExclusionDetails","view details"),window.open(`${q}/s/${Le.default.get(this.props.view,"deweyResult.domain")}/coupon`,"_blank")}onConfirmDismiss(){let t=Le.default.get(this.props,"reward",{});x("trackClick","dismissCreditReminder","",{rewardAmount:t.amount,rewardDisplay:t.type}),this.props.onUserClosePopup("activate later",!0)}onShowNewUserDetails(){x("trackClick","viewNewUserBonusDetails","Details",{view:"cashbackNotificiation"}),window.open("https://help.capitaloneshopping.com/hc/en-us/articles/360047681572-How-do-I-earn-a-New-Member-Bonus-of-10-in-Wikibuy-Credits-on-my-first-purchase-","_blank")}render(){let{activating:t,activated:o}=this.props,i=!!Le.default.get(this.props,"reward.categories"),r=this.props.hasActivatedCompetitor,a=this.props.eligibleForNewUserBonus,n=Le.default.get(this.props.view,"reward"),s="No thanks, I don't want rewards",c=this.props.view.exclusions;return(0,E.jsxs)("div",{className:"cash-back-resolve",style:this.props.isLandscape?{padding:"20px 24px 0 0"}:void 0,children:[(0,E.jsx)(po,{hasActivatedCompetitor:r,onUserClosePopup:this.props.onUserClosePopup,reward:n}),(0,E.jsxs)("div",{className:"credit-prompt",children:[(0,E.jsx)(ci,{domain:S()}),(0,E.jsxs)("div",{children:[O("show_rewards")&&(0,E.jsx)("div",{className:"rewards-activation",children:(0,E.jsx)(di,{...this.props,onShowExclusion:this.onShowExclusion.bind(this)})}),!t&&!o&&!r?(0,E.jsx)(E.Fragment,{children:(0,E.jsx)("h4",{className:"bold activate-later tertiary-link",onClick:l=>lo(l,s,this.props.onUserClosePopup,r,n),children:s})}):(o||t)&&(0,E.jsxs)("div",{children:[(0,E.jsxs)("h6",{style:{display:"flex",marginTop:"6px",paddingLeft:"3px",fontSize:"8px",lineHeight:"10px",paddingBottom:"10px",marginBottom:i?"15px":0,borderBottom:i?"1px solid #dedede":0},children:[(0,E.jsx)("span",{style:{marginRight:"3px"},children:"*"}),(0,E.jsxs)("span",{children:["Rewards may vary based on exchange rates.",Le.default.get(this.props,"view.exclusions")?(0,E.jsxs)(E.Fragment,{children:[" ","Terms and exclusions apply,",(0,E.jsx)("span",{style:{paddingLeft:"3px"},className:"tertiary-link-lighter",onClick:this.onShowExclusion.bind(this),children:"view details."})]}):null]})]}),i?(0,E.jsx)(ii,{reward:this.props.reward,tld:Le.default.get(this.props.view,"deweyResult.domain")}):null,(0,E.jsx)(uo,{reward:this.props.reward}),(o||t)&&c?(0,E.jsx)("div",{style:{paddingTop:"20px"},children:(0,E.jsx)(li,{exclusions:c})}):null]}),(0,E.jsx)(ni,{reward:n,containerStyle:{marginTop:12,textAlign:"left"}}),a&&(0,E.jsxs)("div",{className:"new-user-bonus",children:["Get an ",(0,E.jsx)("span",{className:"bold",children:"additional $10 in Shopping Rewards"})," today with a qualifying purchase of $25."," ",(0,E.jsx)("span",{className:"primary-link",onClick:this.onShowNewUserDetails.bind(this),children:"Details"})]})]})]})]})}},hi=mi;var ke=p(L());Et();var yo=p(Z());var Fn=p(L()),Gd=p(jn());var Hn=p(L());var Gn=p(L());var Wn=p(L());var $n=p(L());var qn=p(L());var qd=p(L());var Fm=p(Ms());function go(e,t){var o=t===void 0?{}:t,i=o.currency,r=i===void 0?"USD":i,a=o.country,n=a===void 0?"US":a,s=o.noDollarSign,c=s===void 0?!1:s,l=o.roundToNearestInteger,m=l===void 0?!1:l,u=o.floorToInteger,f=u===void 0?!1:u,w=o.truncateIntegers,v=w===void 0?!1:w;if(e==null||!Number.isFinite(e))return null;var y=e,h="en-".concat(n==="CA"||n==="AU"||n==="GB"?"US":n);m?y=Math.round(y):f&&(y=Math.floor(y));var g=y.toLocaleString(h,{style:"currency",currency:r==="CAD"||r==="AUD"?"USD":r,minimumFractionDigits:v&&Number.isInteger(y)?0:2});if(c){var k=n==="GB"?"\xA3":"$";g=g.replace(k,"")}return r==="CAD"&&(g+=" CAD"),r==="AUD"&&(g+=" AUD"),r==="GBP"&&(g+=" GBP"),g}var it=p(L());function Ps({pseudoDomain:e,baobabBranch:t,contentProps:o}){let i=[t,"conquest"],[r,a]=(0,it.useState)(),[n,s]=(0,it.useState)(),[c,l]=(0,it.useState)(!0),m=async()=>{let u=d.select(i);try{l(!0),u.set({loading:!0,error:null,data:null});let f=await cr({pseudoDomain:e,contentProps:o,context:sr()});f.error?(a(void 0),s(f.error),u.set(i,{loading:!1,data:null,error:f.error})):(a(f),s(void 0),u.set(i,{loading:!1,data:f,error:null}))}catch(f){let w=f;s(w.toString()),u.set(i,{data:null,error:w,loading:!1})}finally{l(!1)}};return(0,it.useEffect)(()=>{m()},[]),{baobabSelector:i,data:r,error:n,loading:c}}var Ls=p(L());var Rs=p(L()),bo=(0,Rs.createContext)({onUserClosePopup:()=>{},hasActivatedCompetitor:!1,reward:null});var bi=p(b()),Os=({children:e})=>{let{onUserClosePopup:t,hasActivatedCompetitor:o,reward:i}=(0,Ls.useContext)(bo);return t==null?null:(0,bi.jsx)(Vi,{variant:"tertiary",className:"mb-2 w-full",onClick:r=>lo(r,e,t,o,i),children:(0,bi.jsx)("span",{className:"text-gray-400 cursor-pointer font-semibold",children:e})})};var ce=p(b());Yi(e=>{e("sp-energy-cashback-dismissal",Os)});var Bs=(0,ke.memo)(({reward:e,onUserClosePopup:t,hasActivatedCompetitor:o,onActivate:i})=>{let[r,a]=(0,ke.useState)(!1),[n,s]=(0,ke.useState)(!1),[c,l]=(0,ke.useState)(!1),m=S(),u={reward:e,domain:m},{data:f,error:w,loading:v}=Ps({pseudoDomain:m,baobabBranch:"energyCashback",contentProps:u}),y=(0,ke.useCallback)((0,yo.debounce)(async k=>{if("eventName"in k&&k.eventName==="activate_energy_cashback"){a(!0);try{await i({label:"Activate Rewards"}),s(!0)}catch{l(!0)}finally{a(!1)}}},350),[]);if(v)return(0,ce.jsx)("div",{className:"flex p-6 justify-center items-center",children:(0,ce.jsx)(nr,{})});if(w||!f?.notification)return(0,ce.jsx)("div",{className:"flex p-6 justify-center items-center",children:(0,ce.jsx)("p",{className:"text-critical",children:"Encountered an error retrieving content"})});let h=go(e.amount/100,{currency:e.amountCurrency||e.currency,truncateIntegers:!0}),g=Ni(Ii(new Date,1),"MMMM d");return(0,ce.jsxs)(bo.Provider,{value:{onUserClosePopup:t,hasActivatedCompetitor:o,reward:e},children:[(0,ce.jsx)(po,{onUserClosePopup:t}),(0,ce.jsx)(Pt,{client:Mt.DESKTOP_WEB,data:{isActivating:r,isActivated:n,hasActivationError:c,domain:S(),reward:h,expirationDate:g},config:{rootEl:"div",logLevel:void 0},content:f.notification.blocksTemplate,onEvent:y,children:(0,ce.jsx)("style",{children:".object-contain { object-fit: contain; }"})})]})},({reward:e,hasActivatedCompetitor:t},{reward:o,hasActivatedCompetitor:i})=>(0,yo.isEqual)(e,o)&&t===i);var xo=e=>(d.get(["energyCashbackDomains"])||[]).includes(e);var Ce=p(b());function Hm(){return{left:"auto",right:"655px"}}function Gm({offerSignUp:e,storeName:t,hideNotification:o,onDismissTooltip:i,hasSeenCashbackSignupTip:r,hasSeenCashbackActivateTip:a,wrapperStyle:n={}}){let s=Hm();return(0,Ce.jsxs)("div",{style:n,children:[!r&&e&&!o?(0,Ce.jsx)(tt,{tip:!0,message:(0,Ce.jsxs)("span",{children:["Capital One Shopping can help you save ",(0,Ce.jsx)("br",{}),"on ",t," today, just click activate. It's easy and free money."]}),delay:"1500ms",style:{top:"15px",bottom:"auto",width:"461px",left:s.left,right:s.right},onDismissTooltip:i.bind(null,"hasSeenCashbackSignupTip")}):null,!a&&!e&&!o?(0,Ce.jsx)(tt,{tip:!0,tipLabel:"Capital One Shopping tip:",message:(0,Ce.jsx)("span",{children:"Just click when you see this to get free money, seriously."}),delay:"1500ms",style:{top:"15px",bottom:"auto",width:"468px",left:s.left,right:s.right},onDismissTooltip:i.bind(null,"hasSeenCashbackActivateTip")}):null]})}var wt=Gm;var ae=p(b()),yi=class extends zs.Component{constructor(...t){super(...t),this.state={hideNotification:O("ext_rewards_remove_delay")?this.props.view&&R.default.get(this.props,"view.user.activated"):!0,hasSentPossibleExpMetric:!1}}async componentWillReceiveProps(t){this.props&&t&&!this.props.warnAboutStandDown&&t.warnAboutStandDown&&this.state.activated&&this.setState({hideNotification:!1,hasSentPageNotification:!1,activated:!1,activating:!1,hasActivated:!0})}async componentDidUpdate(t,o){if(o.hideNotification!==this.state.hideNotification&&this.sendCashbackPageEvent(),t.warnAboutStandDown!==this.props.warnAboutStandDown&&this.props.warnAboutStandDown&&!d.get("throttleCreditsReactivation")){let i=await kt();d.merge({cashback:i}),await Oe("reactivate")}}componentDidMount(){let t=this.props.view&&R.default.get(this.props,"view.user.activated");setTimeout(()=>{document.querySelector("#honeyContainer")&&this.setState({compNotifLoaded:!0,rightOffset:"300px"}),(document.querySelector(".ebates-notification")||document.querySelector(".ebates-hover.ebates-hover-top"))&&this.setState({compNotifLoaded:!0,rightOffset:"410px"}),O("ext_rewards_remove_delay")||this.setState({hideNotification:t}),this.sendCashbackPageEvent(),wn()},O("ext_rewards_remove_delay")?0:1e3)}async sendCashbackPageEvent(){let t=(0,Us.findDOMNode)(this),o="",i="";if(t){let r=t.querySelector("button");r&&r.textContent&&(o=r.textContent.toLowerCase())}!this.state.hideNotification&&!this.state.hasSentPageNotification&&rt()&&(this.setState({hasSentPageNotification:!0}),x("page","cashbackNotification",{view:"cashbackNotification",type:"notification",source:"cashback",deweyResult:R.default.get(this.props.view,"deweyResult.pageType"),offerSignUp:R.default.get(this.props.view,"offerSignUp"),qualified:R.default.get(this.props.view,"qualified",!1),balance:R.default.get(this.props.view,"balance",0),promotionalRate:void 0,vendorMetaId:R.default.get(this.props.view,"id"),token:R.default.get(this.props.view,"token"),ctaText:o,notificationText:i}))}trackFirstDragEnd=R.default.once((t,o)=>{ir("cashbackNotification",t,o)});render(){let{hideNotification:t}=this.state,o=R.default.get(this.props.view,"offerSignUp"),i=R.default.get(this.props.view,"vendor");if(!this.props.cashbackVisible||this.props.couponsVisible&&!(this.props.couponView&&this.props.couponView.isQuietSavingsMiss)&&!this.props.view.autoActivate||!rt())return!this.state.hasSentPossibleExpMetric&&!rt()&&(this.setState({hasSentPossibleExpMetric:!0}),x("page","possibleExperience",{type:null,source:"credits",notificationText:"credits"})),null;let r=R.default.get(this.props,"view.reward"),a=_n();return(0,ae.jsxs)(er,{onClick:()=>this.setState({fullScreen:!1}),className:`${t?"disabled cashback-page":"cashback-page"}`,style:{top:"0",bottom:"auto",left:a.left??"auto",right:a.right??"0",translate:a.translateX},dragSelector:"header",onDragEnd:this.trackFirstDragEnd,children:[(0,ae.jsx)(vt.Motion,{style:{opacity:(0,vt.spring)(t?0:1,{stiffness:180,damping:20}),tabOpacity:t?0:1,y:(0,vt.spring)(t?-100:0,{stiffness:180,damping:20}),tabX:t?80:0},children:({opacity:n,y:s})=>(0,ae.jsxs)("div",{className:`cashback-notification ${O("notif_rounded_border")?"rounded-notification":""}`,style:{transform:`translate3d(0,${s}%,0)`,opacity:`${n}`},children:[(0,ae.jsxs)("header",{className:"reward-header",children:[(0,ae.jsx)(He,{}),(0,ae.jsx)(rr,{})]}),xo(S())?(0,ae.jsx)(Bs,{reward:r,onUserClosePopup:this.onUserClosePopup.bind(this),hasActivatedCompetitor:this.props.hasActivatedCompetitor,onActivate:this.determineRunCashback.bind(this)}):(0,ae.jsx)(hi,{view:this.props.view,hasActivated:this.state.hasActivated,hasActivatedCompetitor:this.props.hasActivatedCompetitor,reward:r,activated:this.state.activated,activating:this.state.activating,hasCoupons:R.default.get(this.props,"view.hasCoupons"),session:this.props.session,showInitialSignup:this.state.showInitialSignup,tld:this.props.tld,activate:this.state.activate,onActivate:this.determineRunCashback.bind(this),dismissNotification:()=>this.setState({hideNotification:!0}),hasSeenFTUX:R.default.get(this.props,"events.hasSeenCashbackFtux",!1),onUserClosePopup:this.onUserClosePopup.bind(this),deweyResult:R.default.get(this.props.view,"deweyResult"),setSeenCashbackFtux:this.setSeenCashbackFtux.bind(this),eligibleForNewUserBonus:this.props.settings.eligibleForNewUserBonus})]})}),(0,ae.jsx)(wt,{offerSignUp:o,storeName:i,hideNotification:t,onDismissTooltip:this.onDismissTooltip.bind(this),hasSeenCashbackSignupTip:R.default.get(this.props,"events.hasSeenCashbackSignupTip"),hasSeenCashbackActivateTip:R.default.get(this.props,"events.hasSeenCashbackActivateTip")})]})}determineRunCashback(t){return Ie()?this.onActivate(t):(t?.shouldLoadEmailCreateAccountNotification&&this.setState({hideNotification:!0},()=>{Ge()}),Ct())}onDismissTooltip(t){R.default.get(this.props,`events.${t}`)||_t(t)}async onActivate(t={}){let o=R.default.get(this.props.view,"reward",{}),r=R.default.get(this.props.view,"hasCoupons")?1500:5e3;this.setState({activating:!0}),this.onDismissTooltip("hasSeenCashbackActivateTip");let{isRedirectEnabled:a}=await at({reward:o,view:t.view,label:t.label});this.setState({activated:!0}),t.preventHide||setTimeout(()=>{this.setState({hideNotification:!0},()=>{a||Ge(o)})},r),bt()}onUserClosePopup(t,o=!1){let i=R.default.get(this.props.view,"reward",{});(R.default.get(this.props.view,"user.hasSeenFirst")||R.default.get(this.props.view,"isCashbackURLMatch"))&&(so(),Dn("cashback","cta")),this.setState({hideNotification:!0}),R.default.get(this.props.view,"offerSignUp")?this.onDismissTooltip("hasSeenCashbackSignupTip"):this.onDismissTooltip("hasSeenCashbackActivateTip"),o||(x("trackClick","dismissCashbackNotification",t,{rewardAmount:i.amount,rewardDisplay:i.type}),ue("cashbackNotification",t,"dismiss","primary",{rewardAmount:i.amount,rewardDisplay:i.type}))}setSeenCashbackFtux(){_t("hasSeenCashbackFtux")}},xi=Fe({view:["cashbackView"],couponView:["couponView"],deweyResult:["deweyResult"],events:["events"],session:["session"],settings:["settings"],tld:["siteAPIData","siteData","tld"],hasActivatedCompetitor:["hasActivatedCompetitor"],warnAboutStandDown:["warnAboutStandDown"],couponsVisible:["couponsVisible"],cashbackVisible:["cashbackVisible"]},yi);var Y=p(L()),nt=p(Z());var wi=()=>N("setReactivateNotifThrottled",{domain:S()});var M=p(b()),Wm=({children:e})=>(0,M.jsx)("div",{className:"bg-overlay flex justify-center items-center fixed top-0 left-0 w-screen h-screen z-[9999]",children:e}),$m=({children:e})=>(0,M.jsx)("div",{className:"bg-white rounded-lg flex flex-col items-center p-2 w-[400px] h-[240px]",children:e}),qm=({children:e})=>(0,M.jsx)("div",{className:"mt-2 flex justify-between w-full",children:e}),Km=({children:e})=>(0,M.jsx)("div",{className:"flex flex-col items-center mt-8 w-full",children:e}),Vm=e=>{let t=d.get("cashback"),[o,i]=(0,Y.useState)(e.hasActivatedCompetitor||e.warnAboutStandDown),[r,a]=(0,Y.useState)(nt.default.get(t,"user.compInactivated")),[n,s]=(0,Y.useState)(r&&o),[c,l]=(0,Y.useState)(!1),[m,u]=(0,Y.useState)(!1),[f,w]=(0,Y.useState)("Re-activate Rewards"),v=(0,Y.useState)(nt.default.get(e.view,"reward",{})),y=nt.default.get(e,"view.exclusions");(0,Y.useEffect)(()=>{js(e.tld)},[]),(0,Y.useEffect)(()=>{n&&x("page","rewardsReactivation",{view:"rewardsReactivation",type:"notification"})},[n]);let h=async()=>{let A=await kt();d.merge({cashback:A}),a(nt.default.get(d.get("cashback"),"user.compInactivated")),i(e.hasActivatedCompetitor||e.warnAboutStandDown)};(0,Y.useEffect)(()=>{(e.hasActivatedCompetitor||e.warnAboutStandDown)&&h()},[e.hasActivatedCompetitor,e.warnAboutStandDown]),(0,Y.useEffect)(()=>{r&&o&&s(!0)},[r,o]);let g=async()=>{let D=`${d.get(["couponView","hasDeferredCouponRewards"])?"Activate":"Re-activate"} Rewards`;return w(D),D};(0,Y.useEffect)(()=>{g()},[v]);let k=async(A={})=>{l(!0),await at({reward:v,view:"cashbackReactivate",label:f}),l(!1),u(!0),wi(),setTimeout(()=>s(!1),1e3)},$=()=>{x("trackClick","viewExclusionDetails","view details"),window.open(`${q}/s/${e.tld}/coupon`,"_blank")},z=(A,T=!1)=>{let D=nt.default.get(e.view,"reward",{});s(!1),T||(x("trackClick","dismissCashbackNotification",A,{rewardAmount:D.amount,rewardDisplay:D.type}),ue("rewardsReactivation",A,"dismiss","primary",{rewardAmount:D.amount,rewardDisplay:D.type})),wi()};return(0,M.jsx)(M.Fragment,{children:n?(0,M.jsx)(Wm,{children:(0,M.jsxs)($m,{children:[(0,M.jsxs)(qm,{children:[(0,M.jsx)(He,{}),(0,M.jsx)(Nt,{onClick:()=>{z(f)}})]}),(0,M.jsxs)(Km,{children:[(0,M.jsx)("p",{className:"text-2xl leading-9 font-bold text-neutralprimary",children:"Oops! Rewards were disabled."}),(0,M.jsx)("p",{className:"leading-6 text-neutralsecondary",children:"You used another coupon site."}),c?(0,M.jsx)("h5",{className:"bold rewards-only-button red",children:"Activating..."}):m?(0,M.jsx)("h5",{className:"bold rewards-only-button red",children:"Activated!"}):(0,M.jsx)("button",{className:"primary-btn-large red-btn",style:{width:"90%",marginTop:"16px"},onClick:k,children:f}),(c||m)&&(0,M.jsx)("div",{className:`exclusions-wrapper ${c||m?"visible":"invisible"}`,children:(0,M.jsx)("h6",{style:{height:"30px",display:"flex",marginTop:"10px",paddingLeft:"3px",textAlign:"center"},children:(0,M.jsxs)("span",{children:[(0,M.jsx)("div",{children:"* Rewards may vary based on exchange rates."}),y?(0,M.jsxs)("div",{children:[" ","Terms and exclusions apply,",(0,M.jsxs)("span",{className:"tertiary-link-lighter",onClick:$,children:[" ","view details."]})]}):null]})})})]})]})}):null})},_i=Fe({view:["cashbackView"],couponView:["couponView"],offers:["offers"],deweyResult:["deweyResult"],events:["events"],session:["session"],settings:["settings"],tld:["siteAPIData","siteData","tld"],hasActivatedCompetitor:["hasActivatedCompetitor"],warnAboutStandDown:["warnAboutStandDown"],couponsVisible:["couponsVisible"]},Vm);Et();var Fs={cashback:"__wb_cns",sitehub:"__wb_sns"};function Hs(e,t=60){let o=Fs[e];if(!o)return console.error("[throttleNotification] Unknown notification type:",e),!1;let i=parseInt(localStorage.getItem(o))||0;return Ai(new Date,new Date(i))>=t?(localStorage.setItem(o,String(+new Date)),!0):!1}function Gs(e){let t=Fs[e];if(!t){console.error("[clearThrottle] Unknown notification type:",e);return}localStorage.removeItem(t)}var le=p(L()),nc=p(zi());Fi();var Ws="Cashback_Rewards";var wo=p(L());async function Ym(e,t){let o=$i(e),i=await qi(o);if(!i)return null;let r=await or();return{config:{rootEl:"div",logLevel:null},content:i,data:t,...r}}function $s(e,t){let[o,i]=(0,wo.useState)(null);return(0,wo.useEffect)(()=>{Ym(e,t).then(r=>i(r)).catch(console.error)},[]),o}var ic=p(Qs());Fi();var oh="Rewards",ih="prefix",rh="prefix_lower",ah="threshold_prefix",nh="threshold_prefix_lower",sh="up_to",ch="up_to_lower",lh="suffix",ph="max_payout",fh="suffix_threshold_condition";function Js(e,t,{capitalizePrefix:o=!0}={}){return e.type==="threshold"&&e.threshold?t(o?ah:nh):t(o?ih:rh)}function ec(e,t,o,{capitalizeUpTo:i=!1,hideUpTo:r=!1}={}){var a,n;let s="";!r&&e.categories&&(s=t(i?sh:ch));let c=!((a=e.tiers)===null||a===void 0)&&a.length?e.tiers[e.tiers.length-1].reward.type:e.type,l=!((n=e.tiers)===null||n===void 0)&&n.length?e.tiers[e.tiers.length-1].reward.value:e.amount,m=c==="percentage"?`${l/100}%`:o(l),u="";if(e.maxPayoutAmount){let f=o(e.maxPayoutAmount);u+=t(ph,{parseValues:{formattedMaxPayoutAmount:f}})}return s+m+u}function tc(e,t,o){var i;let r="";if(e.type==="threshold"&&e.threshold){let a=!((i=e.tiers)===null||i===void 0)&&i.length?e.tiers[e.tiers.length-1].spendCents:e.threshold,n=o(a);r=t(fh,{parseValues:{formattedSpendThreshold:n}})}return t(lh)+r}function uh(e,t,o,{capitalizePrefix:i=!0,capitalizeUpTo:r=!1,hideUpTo:a=!1}={}){let n=Js(e,t,{capitalizePrefix:i}),s=ec(e,t,o,{capitalizeUpTo:r,hideUpTo:a}),c=tc(e,t,o);return`${n}${s}${c}`}function oc(e){let{getValue:t}=It(oh),{formatCurrency:o}=Xi(),i=c=>o(c,e);return{getFullDescription:(c,l)=>uh(c,t,i,l),getPrefix:(c,l)=>Js(c,t,l),getText:(c,l)=>ec(c,t,i,l),getSuffix:c=>tc(c,t,i)}}function rc(){let{cashbackView:e,couponView:t,events:o,settings:i,hasActivatedCompetitor:r,warnAboutStandDown:a,couponsVisible:n,throttleCreditsReactivation:s,userCountry:c,userCurrency:l}=(0,ic.useBranch)({cashbackView:["cashbackView"],couponView:["couponView"],events:["events"],session:["session"],settings:["settings"],hasActivatedCompetitor:["hasActivatedCompetitor"],warnAboutStandDown:["warnAboutStandDown"],couponsVisible:["couponsVisible"],throttleCreditsReactivation:["throttleCreditsReactivation"],tld:["siteAPIData","siteData","tld"],userCountry:["session","country"],userCurrency:["siteAPIData","meta","currency"]}),{autoActivate:m,balance:u,exclusions:f,hasCoupons:w,id:v,isCashbackURLMatch:y,offerSignUp:h,qualified:g,reward:k,token:$,user:z,vendor:A}=e,T=c||"US",D=k?.amountCurrency||k?.currency||l,{getPrefix:I,getText:X,getSuffix:Se}=oc({country:T,currency:D,truncateIntegers:!0}),me=!!(z&&z.activated),Te=!!(z&&z.hasSeenFirst),{isQuietSavingsMiss:ze}=t,{eligibleForNewUserBonus:Ue}=i,St="hasSeenCashbackSignupTip"in o,_="hasSeenCashbackActivateTip"in o,{type:Ee,amount:pc,categories:Co,threshold:fc,tiers:uc}=k,Tt=uc?.map(To=>({...To,spendCents:To.spendCents||To.spend_cents}))??[],dc=!!(Co&&Co.length>0),mc=Tt?.length>0?Tt[Tt.length-1].spendCents:fc,hc=I(k),gc=X(k),bc=Se(k),{pageType:yc,domain:Di}=e.deweyResult,xc=rt(),wc=Ie(),So=S(),_c=lt(So),vc=So==="quill.com",kc=Re(So),Cc=!_c,Sc=`${q}/s/${Di}/coupon`;return{allowNotification:xc,warnAboutStandDown:a,hasSeenCashbackSignupTip:St,hasSeenCashbackActivateTip:_,hasActivatedCompetitor:r,hasCategories:dc,hasCoupons:w,isCashbackURLMatch:y,deweyDomain:Di,deweyPageType:yc,offerSignUp:h,qualified:g,balance:u,vendorMetaId:v,exclusionDetailsLink:Sc,websiteExclusions:f,token:$,eligibleForNewUserBonus:Ue,vendor:A,couponsVisible:n,isQuietSavingsMiss:ze,autoActivate:m,reward:k,rewardAmount:pc,rewardType:Ee,rewardThreshold:mc,rewardCategories:Co,rewardTiers:Tt,rewardPrefixText:hc,rewardText:gc,rewardSuffixText:bc,useRedCta:Cc,activated:me,isFullAccount:wc,isQuillDomain:vc,isWayfairDomain:kc,throttleCreditsReactivation:s,userHasSeenFirst:Te}}var Be=p(b());function dh(e){let{getValue:t}=It(Ws),o=rc(),{activated:i,allowNotification:r,hasCoupons:a,hasSeenCashbackActivateTip:n,hasSeenCashbackSignupTip:s,isCashbackURLMatch:c,isFullAccount:l,offerSignUp:m,reward:u,throttleCreditsReactivation:f,userHasSeenFirst:w,vendor:v,warnAboutStandDown:y}=o,h=$s("blocks-cashback-rewards"),[g,k]=(0,le.useState)(i),[$,z]=(0,le.useState)(!1),[A,T]=(0,le.useState)(!1),[D,I]=(0,le.useState)(!1),[X,Se]=(0,le.useState)(!1);(0,le.useEffect)(()=>{if(A||g||!r)return;let _=t("cta_text");x("page","cashbackNotification",{view:"cashbackNotification",type:"notification",source:"cashback",deweyResult:o.deweyPageType,offerSignUp:o.offerSignUp,qualified:o.qualified,balance:o.balance,promotionalRate:void 0,vendorMetaId:o.vendorMetaId,token:o.token,ctaText:_,notificationText:""}),T(!0)},[A,g]),(0,le.useEffect)(()=>{async function _(){!y||f||D||(await ac(),I(!0))}_()},[y,f,D]),(0,le.useEffect)(()=>{X||r||(x("page","possibleExperience",{type:null,source:"credits",notificationText:"credits"}),Se(!0))},[X,r]);let me=async()=>(x("track","signinRequired",{vendor:v}),await Lt()?(k(!0),Ge()):window.open(`${q}/sign-in`),Ct()),Te=_=>{(_==="hasSeenCashbackSignupTip"&&!s||_==="hasSeenCashbackActivateTip"&&!n)&&_t(_)},ze=async()=>{if(z(!0),!l)return me();Te("hasSeenCashbackActivateTip");let _=t("cta_text"),{isRedirectEnabled:Ee}=await at({reward:u,label:_,pageLocation:void 0,view:void 0});setTimeout(()=>{Ee||Ge(u),k(!0)},a?1500:5e3),bt()},Ue=_=>{(w||c)&&so(),k(!0),Te(m?"hasSeenCashbackSignupTip":"hasSeenCashbackActivateTip"),x("trackClick","dismissCashbackNotification",_,{rewardAmount:u.amount,rewardDisplay:u.type}),ue("cashbackNotification",_,"dismiss","primary",{rewardAmount:u.amount,rewardDisplay:u.type})};return{blocksConfig:h,data:o,handleBlocksEvent:_=>{if(tr(_,e),_.type===Ao.NotificationDismiss&&Ue("Dismiss Notification"),_.type===Ao.Custom)switch(_.eventName){case"activateReward":ze();break;case"dismiss":Ue(t("dismiss_button_text"));break;default:break}},handleDismissTooltip:Te,hideNotification:g,isActivating:$,setIsActivating:z,activated:i,hasSentPageNotification:A}}function vo({onUnload:e}){let{blocksConfig:t,data:o,handleBlocksEvent:i,handleDismissTooltip:r,hideNotification:a,isActivating:n,activated:s,hasSentPageNotification:c}=dh(e),{allowNotification:l,couponsVisible:m,hasSeenCashbackActivateTip:u,hasSeenCashbackSignupTip:f,isQuietSavingsMiss:w,autoActivate:v,offerSignUp:y,vendor:h}=o,g=xt(`${At}?${nc.default.stringify({domain:o.deweyDomain,width:300,height:300})}`);return!t||a||!l||m&&!w&&!v?null:(0,Be.jsxs)(Be.Fragment,{children:[(0,Be.jsx)(Pt,{client:Mt.DESKTOP_WEB,config:{...t.config,disableAnimation:c},content:t.content,host:t.host,user:t.user,data:{...o,isActivating:n,activated:s,logoImageUri:g},onEvent:i}),(0,Be.jsx)(wt,{offerSignUp:y,storeName:h,hideNotification:a,onDismissTooltip:r,hasSeenCashbackSignupTip:f,hasSeenCashbackActivateTip:u})]})}var ko=p(b());function mh(){return d.get("hasActivatedCompetitor")||d.get("warnAboutStandDown")}function hh(){return xo(S())?!1:O("should_use_blocks_service")&&O("ext_blocks_cashback_rewards_switch")}var cc;function gh(){cc?.()}async function Oe(e="cashback"){let t;e==="reactivate"?t=(0,ko.jsx)(_i,{}):hh()?t=(0,ko.jsx)(vo,{onUnload:gh}):t=(0,ko.jsx)(xi,{}),cc=(await Rt({appName:e,cssUrl:"cashback.css",app:t})).unloadApp,d.set("cashbackVisible",!0),e==="reactivate"&&(Zi("cashback"),d.set("cashbackReactivateVisible",!0))}var bh={devRewardTest:!1};async function yh(e,t){let{devRewardTest:o=!1}=t??bh,i=d.get("cashback"),r=mh()&&W.default.get(i,"user.compInactivated"),a=sc.default.getDomain(location.href);if(a?.match(/hilton\.com/)&&O("cb_hilton_honors"))return;let n=a&&Oi(a)&&O("expedia_extension_testing_q2_2025"),s=!1,c=["cartPage","checkoutPage","reviewPage"],{siteData:l,meta:m}=d.get("siteAPIData")||await Ji(),u=l.cashback?.pageTypeOverrides||W.default.get(l.cashback,"pageTypesOverride",{})||{},f=W.default.get(e,"pageType");if(u&&u[f]){let y=u[f],h=W.default.get(y,"value",y),g;if(h==="show"?s=!0:h==="hide"?s=!1:h==="conditional"&&y.conditional&&(g=xh(y.conditional),!g||g.type==="hide"&&g.hide?s=!1:s=!0),x("track","cashbackNotificationOverride",{show:s,reason:W.default.get(g,"feature","")}),!s)return}else if(n&&!["cartPage","checkoutPage","confirmationPage"].includes(f))Hs("cashback")&&(s=!0,Gs("sitehub"));else if(r)s=!0;else if(c){if(s=c.indexOf(f)!==-1,r&&(s=!0),i&&(W.default.get(i,"user.activated")||r)&&!s&&!W.default.get(i,"user.dismissed")&&!d.get("cashbackVisible")&&!d.get("couponsVisible")&&!d.get("cashbackReactivateVisible")&&!d.get("throttleCreditsReactivation")){await Oe("reactivate");return}}else f=W.default.snakeCase(f),s=new Set(l.cashback.minNotificationsPageTypes).has(f);if(o&&(s=!0),!s){let y=Object.keys(l.pageTypesV2||{}),h=y.includes("cartPage"),g=y.includes("checkoutPage");(!h&&new RegExp(/^\/cart(?![\w-~!$&'()*+,;=:@%])/i).test(location.pathname)||!g&&new RegExp(/^\/checkout(?![\w-~!$&'()*+,;=:@%])/i).test(location.pathname))&&(s=!0)}let w=n?i?.user?.dismissed&&i?.user?.dismissedPageType==="checkoutPage":i?.user?.dismissed;if(!i||!s||w||d.get("cashbackVisible")||d.get("cashbackReactivateVisible"))return;if((dn()||mn())&&!r){gn();return}else if(hn()){bn();return}let v=d.get("cashbackView")||i;if(d.set("cashbackView",{...v,isCashbackURLMatch:!0,deweyResult:e,ebatesReward:l.ebatesReward,exclusions:W.default.get(l,"merchantPage.exclusions"),affiliateLinkCurrentTab:W.default.get(m,"affiliate_link_current_tab")}),r&&!W.default.get(i,"user.activated")&&!d.get("couponsVisible")&&!d.get("throttleCreditsReactivation")){d.set(["warnAboutStandDown"],!0),await Oe("reactivate");return}await Oe()}function xh(e){try{let t=JSON.parse(e),o=W.default.map(t.hide,n=>({hide:O(n),feature:n,type:"hide"})),i=W.default.map(t.show,n=>({show:O(n),feature:n,type:"show"})),r=W.default.find(o,{hide:!0}),a=W.default.find(i,{show:!0});return r||a||!1}catch{return!1}}var lc=e=>N("checkIfInPriceComparison",e);var wh=new Set(["ebay.com","stubhub.com","stubhub.ca"]);async function Ti(e){if(wh.has(e))return lc(e)}async function kt(e=!1){let t=!1,o=await xn(e);return(o&&de.default.get(o,"reward.amount")||e&&o?.hasDeferredProgramSelection)&&(t=o),t}async function ac(){let e=await kt();d.merge({cashback:e}),await Oe("reactivate")}function _t(e){let t={[e]:Date.now()},o=de.default.cloneDeep(d.get(["events"]));o=de.default.merge(o,t),d.set(["events"],o),yn(e)}async function js(e){let t={rakuten:"rakuten",honey:"honey",rmn:"rmn"},o=await no(t.honey),i=await no(t.rakuten),r=await no(t.rmn),a="";o&&(a="honey"),r&&(a="rmn"),i&&(a="rakuten"),chrome.storage.local.set({[`${a}WarningNotif-${e}`]:Dt()},()=>{i&&ht(t.rakuten),o&&ht(t.honey),r&&ht(t.rmn),a===""&&ht(a)})}async function Ct({token:e,clickId:t,coupons:o,codeEntered:i,autoSavings:r=!1,fromAutoRun:a,fromActivateRewards:n,isSiteHub:s}={}){let c=S();d.set(["couponsAffiliateDisabledSites",`${c}_${d.get("tabId")}`],je(Eo(new Date,30)));let l=t||Ei.default.v4().replace(/-/g,""),m=await Zo({pageViewId:d.get("pageViewId"),clickId:l,domain:c,coupons:o,codeEntered:i,programId:d.get(["siteAPIData","programId"]),vendorMetaId:d.get("cashback","id"),token:e||d.get("cashback","token"),fromAutoRun:a,autoSavings:r,fromActivateRewards:n,isSiteHub:s});return o&&m?.tripId&&d.set(["couponView","tripId"],m.tripId),m}async function _h({token:e}={}){let t=S();await Promise.all([Qo("affiliateRedirect",JSON.stringify({redirected:!0,location:location.href})),Qo("emailCreateAccount",JSON.stringify({shouldLoadNotification:!0}))]),d.set(["couponsAffiliateDisabledSites",`${t}_${d.get("tabId")}`],je(Eo(new Date,30)));let o=Ei.default.v4().replace(/-/g,""),i,r="cashback",a=await Ti(t);a&&(r="cashback-ims");let n={destUrl:location.href,channel:r,subExperience:"credits",redirectId:Ui(o),sameTab:!0,vendorMetaId:d.get("cashback","id"),token:e||d.get("cashback","token"),clickEvent:"cashbackRedirect",...!a&&{destDomain:d.get("siteAPIData","tld")}},s=d.get("cashback","redirectUrl");s?i=Bi(s,{extensionVersion:chrome.runtime.getManifest().version,subExperience:n.subExperience,redirectId:n.redirectId,clickEvent:n.clickEvent}):i=Qi({params:n});let c={affiliateUrl:i,pageViewId:d.get("pageViewId"),clickId:o,domain:t,preventPinnedTab:!0,vendorMetaId:d.get("cashback","id"),token:e||d.get("cashback","token"),programId:d.get(["siteAPIData","programId"])};return Zo(c),c}async function at({reward:e,token:t,pageLocation:o,view:i,label:r="",sendClickEvent:a=!0}){x("trackClick","activateCashback","activate",{rewardAmount:e.amount,rewardDisplay:e.type,label:r,view:i,pageLocation:o});let n=o==="sitehub";a&&ue(n?"siteHubOffers":i==="cashbackReactivate"?"rewardsReactivation":"cashbackNotification",r,"cta","primary",{redirect:!0,cashback:!!e.amount,rewardAmount:e.amount,rewardDisplay:e.type,view:i,triggerType:We({isSiteHub:n})});let s=d.get(["siteAPIData"]),c=d.get(["deweyResult"]),l=de.default.get(c,"pageData.meta"),m=!0;if(l&&de.default.has(l,"disable_aff_link_current_tab")&&(m=!1),m&&de.default.get(s,"meta.affiliate_link_current_tab")){let f=await _h({token:t});return x("track","activateCashbackRedirect",de.default.assign({rewardAmount:e.amount,rewardDisplay:e.type,view:i},f)),location.href=f.affiliateUrl,{isRedirectEnabled:!0}}d.set(["cashbackView","user","activating"],!0),d.set(["cashback","user","activating"],!0),d.set(["offers","cashback","user","activating"],!0);let u=await Ct({token:t});return d.set(["cashbackView","user","activated"],!0),d.set(["cashback","user","activated"],!0),d.set(["offers","cashback","user","activated"],!0),x("track","activateCashbackRedirect",de.default.assign({rewardAmount:e.amount,rewardDisplay:e.type,view:i},u)),{isRedirectEnabled:!1}}function rt(){let e=!0;if(O("ext_ae_api_v_2")){let t=d.get(["couponView","elasticityUserDomain"]);t&&!t?.i&&(e=t.s)}return!!e}var OE=e=>N("activateCashback",e);export{We as a,Vo as b,dn as c,mn as d,hn as e,gn as f,bn as g,Qo as h,ue as i,Ti as j,kt as k,_t as l,Ct as m,_h as n,at as o,_n as p,bt as q,Dn as r,vk as s,ii as t,ri as u,ni as v,xt as w,f0 as x,ci as y,uo as z,li as A,Re as B,pi as C,tt as D,jd as E,Fd as F,Hd as G,mo as H,_i as I,Hs as J,oc as K,mh as L,Oe as M,yh as N,OE as O};
/*! Bundled license information:

exenv/index.js:
  (*!
    Copyright (c) 2015 Jed Watson.
    Based on code that is Copyright 2013-2015, Facebook, Inc.
    All rights reserved.
  *)

lodash-es/lodash.js:
  (**
   * @license
   * Lodash (Custom Build) <https://lodash.com/>
   * Build: `lodash modularize exports="es" -o ./`
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)
*/
